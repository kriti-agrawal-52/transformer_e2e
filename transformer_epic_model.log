2025-06-06 19:45:16,310 - __main__ - INFO - Starting training process with mode: single
2025-06-06 19:45:16,310 - src.data.processing - INFO - Loading wikitext dataset.
2025-06-06 19:45:47,241 - datasets.load - WARNING - Using the latest cached version of the dataset since wikitext couldn't be found on the Hugging Face Hub
2025-06-06 19:45:47,244 - datasets.packaged_modules.cache.cache - WARNING - Found the latest cached dataset configuration 'wikitext-2-raw-v1' at /Users/kritiagrawal/.cache/huggingface/datasets/wikitext/wikitext-2-raw-v1/0.0.0/b08601e04326c79dfdd32d625aee71d232d685c3 (last modified on Wed May 21 17:14:25 2025).
2025-06-06 19:45:47,310 - src.data.processing - INFO - Successfully loaded dataset.
2025-06-06 19:45:47,486 - src.data.processing - INFO - Truncated wikitext to 10929707 characters for CPU training.
2025-06-06 19:45:47,486 - src.data.processing - INFO - Loading tokenizer 'gpt2'...
2025-06-06 19:46:35,265 - src.training.manager - INFO - --- Starting Single Training Run ---
2025-06-06 19:46:38,822 - src.data.processing - INFO - Tokenizing the entire dataset..
2025-06-06 19:46:54,860 - src.data.processing - INFO - Tokenization complete. Total tokens: 2403644
2025-06-06 19:46:55,199 - src.data.processing - INFO - Train tokens: 1946952, Val tokens: 216327, Test tokens: 240365
2025-06-06 19:46:55,446 - src.models.transformer - INFO - Using uniform dropout rate of 0.2 for all 8 layers.
2025-06-06 19:46:55,897 - src.training.utils - INFO - No checkpoint found. Starting fresh.
2025-06-06 19:46:57,528 - src.training.utils - INFO - Starting/Resuming training on cpu
2025-06-06 19:51:30,907 - __main__ - INFO - Training process finished.
2025-06-06 23:51:14,311 - __main__ - INFO - Starting training process with mode: single
2025-06-06 23:51:14,311 - src.data.processing - INFO - Loading wikitext dataset.
2025-06-06 23:51:25,691 - src.data.processing - INFO - Successfully loaded dataset.
2025-06-06 23:51:25,923 - src.data.processing - INFO - Truncated wikitext to 10929707 characters for CPU training.
2025-06-06 23:51:25,924 - src.data.processing - INFO - Loading tokenizer 'gpt2'...
2025-06-06 23:51:27,270 - src.training.manager - INFO - --- Starting Single Training Run ---
2025-06-06 23:51:30,337 - src.data.processing - INFO - Tokenizing the entire dataset..
2025-06-06 23:51:49,931 - src.data.processing - INFO - Tokenization complete. Total tokens: 2403644
2025-06-06 23:51:50,215 - src.data.processing - INFO - Train tokens: 1946952, Val tokens: 216327, Test tokens: 240365
2025-06-06 23:51:50,412 - src.models.transformer - INFO - Using uniform dropout rate of 0.2 for all 8 layers.
2025-06-06 23:51:50,808 - src.training.utils - INFO - No checkpoint found. Starting fresh.
2025-06-06 23:51:52,721 - src.training.utils - INFO - Starting/Resuming training on cpu
2025-06-06 23:54:47,913 - __main__ - INFO - Training process finished.
2025-06-07 00:21:30,680 - __main__ - INFO - Starting training process with mode: single
2025-06-07 00:21:30,680 - src.data.processing - INFO - Loading wikitext dataset.
2025-06-07 00:21:40,980 - src.data.processing - INFO - Successfully loaded dataset.
2025-06-07 00:21:41,163 - src.data.processing - INFO - Truncated wikitext to 10929707 characters for CPU training.
2025-06-07 00:21:41,164 - src.data.processing - INFO - Loading tokenizer 'gpt2'...
2025-06-07 00:21:42,241 - src.training.manager - INFO - --- Starting Single Training Run ---
2025-06-07 00:21:45,503 - src.data.processing - INFO - Tokenizing the entire dataset..
2025-06-07 00:22:10,335 - src.data.processing - INFO - Tokenization complete. Total tokens: 2403644
2025-06-07 00:22:10,600 - src.data.processing - INFO - Train tokens: 1946952, Val tokens: 216327, Test tokens: 240365
2025-06-07 00:22:10,773 - src.models.transformer - INFO - Using uniform dropout rate of 0.2 for all 8 layers.
2025-06-07 00:22:11,150 - src.training.utils - INFO - No checkpoint found. Starting fresh.
2025-06-07 00:22:12,770 - src.training.utils - INFO - Starting/Resuming training on cpu
2025-06-07 00:22:41,401 - __main__ - INFO - Training process finished.
2025-06-10 00:48:33,823 - __main__ - INFO - Starting training process with mode: single
2025-06-10 00:48:33,824 - src.data.processing - INFO - Loading wikitext dataset.
2025-06-10 00:48:46,804 - src.data.processing - INFO - Successfully loaded dataset.
2025-06-10 00:48:46,986 - src.data.processing - INFO - Truncated wikitext to 10000000 characters for CPU training.
2025-06-10 00:48:46,986 - src.data.processing - INFO - Loading tokenizer 'gpt2'...
2025-06-10 00:48:48,342 - src.training.manager - INFO - --- Starting Single Training Run ---
2025-06-10 00:48:48,343 - src.training.manager - INFO - No previous data for single_bs32_cw256_lr3e-04. Starting fresh training.
2025-06-10 00:48:48,343 - src.training.manager - INFO - Starting training run: single_bs32_cw256_lr3e-04
2025-06-10 00:48:51,773 - src.training.manager - INFO - Run created at: 2025-06-10 00:48:48
2025-06-10 00:48:51,799 - src.data.processing - INFO - Tokenizing the entire dataset..
2025-06-10 00:49:08,919 - src.data.processing - INFO - Tokenization complete. Total tokens: 2197766
2025-06-10 00:49:09,155 - src.data.processing - INFO - Train tokens: 1780191, Val tokens: 197798, Test tokens: 219777
2025-06-10 00:49:09,421 - src.models.transformer - INFO - Linearly scaling dropout from 0.100 to 0.200 over 8 layers. Result: [0.1, 0.114, 0.129, 0.143, 0.157, 0.171, 0.186, 0.2]
2025-06-10 00:49:09,963 - src.training.utils - INFO - No checkpoint found. Starting fresh.
2025-06-10 00:49:12,325 - src.training.utils - INFO - Starting/Resuming training on cpu
2025-06-10 00:52:47,262 - __main__ - INFO - Training process finished.
2025-06-10 00:54:26,166 - __main__ - INFO - Starting training process with mode: single
2025-06-10 00:54:26,167 - src.data.processing - INFO - Loading wikitext dataset.
2025-06-10 00:54:38,180 - src.data.processing - INFO - Successfully loaded dataset.
2025-06-10 00:54:38,450 - src.data.processing - INFO - Truncated wikitext to 10000000 characters for CPU training.
2025-06-10 00:54:38,451 - src.data.processing - INFO - Loading tokenizer 'gpt2'...
2025-06-10 00:54:39,477 - src.training.manager - INFO - --- Starting Single Training Run ---
2025-06-10 00:54:39,477 - src.training.manager - INFO - No previous data for single_bs32_cw256_lr3e-04. Starting fresh training.
2025-06-10 00:54:39,477 - src.training.manager - INFO - Starting training run: single_bs32_cw256_lr3e-04
2025-06-10 00:54:42,149 - src.training.manager - INFO - Run created at: 2025-06-10 00:54:39
2025-06-10 00:54:42,164 - src.data.processing - INFO - Tokenizing the entire dataset..
2025-06-10 00:54:55,098 - __main__ - INFO - Training process finished.
2025-06-10 00:56:32,041 - __main__ - INFO - Starting training process with mode: single
2025-06-10 00:56:32,041 - src.data.processing - INFO - Loading wikitext dataset.
2025-06-10 00:56:45,078 - src.data.processing - INFO - Successfully loaded dataset.
2025-06-10 00:56:45,195 - src.data.processing - INFO - Truncated wikitext to 10000000 characters for CPU training.
2025-06-10 00:56:45,196 - src.data.processing - INFO - Loading tokenizer 'gpt2'...
2025-06-10 00:56:46,169 - src.training.manager - INFO - --- Starting Single Training Run ---
2025-06-10 00:56:46,169 - src.training.manager - INFO - No previous data for single_bs8_cw64_lr3e-04. Starting fresh training.
2025-06-10 00:56:46,169 - src.training.manager - INFO - Starting training run: single_bs8_cw64_lr3e-04
2025-06-10 00:56:48,660 - src.training.manager - INFO - Run created at: 2025-06-10 00:56:46
2025-06-10 00:56:48,676 - src.data.processing - INFO - Tokenizing the entire dataset..
2025-06-10 00:56:59,434 - src.data.processing - INFO - Tokenization complete. Total tokens: 2197766
2025-06-10 00:56:59,760 - src.data.processing - INFO - Train tokens: 1780191, Val tokens: 197798, Test tokens: 219777
2025-06-10 00:56:59,819 - src.models.transformer - INFO - Linearly scaling dropout from 0.100 to 0.200 over 3 layers. Result: [0.1, 0.15, 0.2]
2025-06-10 00:56:59,905 - src.training.utils - INFO - No checkpoint found. Starting fresh.
2025-06-10 00:57:01,343 - src.training.utils - INFO - Starting/Resuming training on cpu
2025-06-10 00:57:57,417 - src.training.utils - INFO - [Step 100/10000] Train: 7.8419, Val: 7.8365
2025-06-10 00:57:59,528 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs8_cw64_lr3e-04_bs8_cw64_lr3e-04_latest.pt at step 100
2025-06-10 00:58:02,147 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs8_cw64_lr3e-04_bs8_cw64_lr3e-04_best.pt at step 100
2025-06-10 00:58:02,148 - src.training.utils - INFO -  New Best Model (Val: 7.8365)
2025-06-10 00:58:56,657 - src.training.utils - INFO - [Step 200/10000] Train: 7.6805, Val: 7.7034
2025-06-10 00:58:59,052 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs8_cw64_lr3e-04_bs8_cw64_lr3e-04_latest.pt at step 200
2025-06-10 00:59:01,520 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs8_cw64_lr3e-04_bs8_cw64_lr3e-04_best.pt at step 200
2025-06-10 00:59:01,520 - src.training.utils - INFO -  New Best Model (Val: 7.7034)
2025-06-10 00:59:06,359 - __main__ - INFO - Training process finished.
2025-06-10 00:59:18,220 - __main__ - INFO - Starting training process with mode: single
2025-06-10 00:59:18,220 - src.data.processing - INFO - Loading wikitext dataset.
2025-06-10 00:59:30,653 - src.data.processing - INFO - Successfully loaded dataset.
2025-06-10 00:59:30,806 - src.data.processing - INFO - Truncated wikitext to 10000000 characters for CPU training.
2025-06-10 00:59:30,806 - src.data.processing - INFO - Loading tokenizer 'gpt2'...
2025-06-10 00:59:31,920 - src.training.manager - INFO - --- Starting Single Training Run ---
2025-06-10 00:59:31,920 - src.training.manager - INFO - Found checkpoints for incomplete run single_bs8_cw64_lr3e-04. Resuming interrupted training.
2025-06-10 00:59:31,921 - src.training.manager - INFO - Resuming training run: single_bs8_cw64_lr3e-04
2025-06-10 00:59:34,479 - src.training.manager - INFO - Run created at: 2025-06-10 00:59:31
2025-06-10 00:59:34,497 - src.data.processing - INFO - Tokenizing the entire dataset..
2025-06-10 00:59:45,152 - src.data.processing - INFO - Tokenization complete. Total tokens: 2197766
2025-06-10 00:59:45,335 - src.data.processing - INFO - Train tokens: 1780191, Val tokens: 197798, Test tokens: 219777
2025-06-10 00:59:45,391 - src.models.transformer - INFO - Linearly scaling dropout from 0.100 to 0.200 over 3 layers. Result: [0.1, 0.15, 0.2]
2025-06-10 00:59:45,468 - src.training.utils - INFO - Found checkpoint: model_checkpoints/run_single_bs8_cw64_lr3e-04_bs8_cw64_lr3e-04_latest.pt. Attempting to resume.
2025-06-10 00:59:45,852 - src.training.utils - INFO - Resuming from step 201 with best_val_loss 7.8365
2025-06-10 00:59:47,034 - src.training.utils - INFO - Starting/Resuming training on cpu
2025-06-10 00:59:47,036 - src.training.utils - INFO - Loaded optimizer state from checkpoint.
2025-06-10 01:00:21,814 - __main__ - INFO - Training process finished.
2025-06-10 01:20:03,786 - __main__ - INFO - Starting training process with mode: single
2025-06-10 01:20:03,786 - src.data.processing - INFO - Loading wikitext dataset.
2025-06-10 01:20:16,860 - src.data.processing - INFO - Successfully loaded dataset.
2025-06-10 01:20:17,622 - src.data.processing - INFO - Truncated wikitext to 10000000 characters for CPU training.
2025-06-10 01:20:17,623 - src.data.processing - INFO - Loading tokenizer 'gpt2'...
2025-06-10 01:20:20,211 - src.training.manager - INFO - --- Starting Single Training Run ---
2025-06-10 01:20:20,212 - src.training.manager - INFO - No previous data for single_bs4_cw12_lr3e-04. Starting fresh training.
2025-06-10 01:20:20,213 - src.training.manager - INFO - Starting training run: single_bs4_cw12_lr3e-04
2025-06-10 01:20:23,178 - src.training.manager - INFO - Run created at: 2025-06-10 01:20:20
2025-06-10 01:20:23,296 - src.data.processing - INFO - Tokenizing the entire dataset..
2025-06-10 01:20:42,259 - src.data.processing - INFO - Tokenization complete. Total tokens: 2197766
2025-06-10 01:20:42,484 - src.data.processing - INFO - Train tokens: 1780191, Val tokens: 197798, Test tokens: 219777
2025-06-10 01:20:42,551 - src.models.transformer - INFO - Linearly scaling dropout from 0.100 to 0.200 over 3 layers. Result: [0.1, 0.15, 0.2]
2025-06-10 01:20:42,646 - src.training.utils - INFO - No checkpoint found. Starting fresh.
2025-06-10 01:20:44,306 - src.training.utils - INFO - Starting/Resuming training on cpu
2025-06-10 01:21:05,226 - src.training.utils - INFO - [Step 100/1000] Train: 8.7624, Val: 8.3586
2025-06-10 01:21:07,923 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_bs4_cw12_lr3e-04_latest.pt at step 100
2025-06-10 01:21:10,880 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_bs4_cw12_lr3e-04_best.pt at step 100
2025-06-10 01:21:10,882 - src.training.utils - INFO -  New Best Model (Val: 8.3586)
2025-06-10 01:21:32,889 - src.training.utils - INFO - [Step 200/1000] Train: 7.9001, Val: 8.0088
2025-06-10 01:21:35,439 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_bs4_cw12_lr3e-04_latest.pt at step 200
2025-06-10 01:21:41,006 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_bs4_cw12_lr3e-04_best.pt at step 200
2025-06-10 01:21:41,008 - src.training.utils - INFO -  New Best Model (Val: 8.0088)
2025-06-10 01:22:05,205 - src.training.utils - INFO - [Step 300/1000] Train: 8.6937, Val: 7.7417
2025-06-10 01:22:08,028 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_bs4_cw12_lr3e-04_latest.pt at step 300
2025-06-10 01:22:10,976 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_bs4_cw12_lr3e-04_best.pt at step 300
2025-06-10 01:22:10,979 - src.training.utils - INFO -  New Best Model (Val: 7.7417)
2025-06-10 01:22:36,078 - src.training.utils - INFO - [Step 400/1000] Train: 7.9447, Val: 7.8437
2025-06-10 01:22:38,822 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_bs4_cw12_lr3e-04_latest.pt at step 400
2025-06-10 01:22:38,823 - src.training.utils - INFO -  No improvement: 1/50
2025-06-10 01:23:00,786 - src.training.utils - INFO - [Step 500/1000] Train: 7.6803, Val: 7.9061
2025-06-10 01:23:03,488 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_bs4_cw12_lr3e-04_latest.pt at step 500
2025-06-10 01:23:03,489 - src.training.utils - INFO -  No improvement: 2/50
2025-06-10 01:23:24,894 - src.training.utils - INFO - [Step 600/1000] Train: 6.8512, Val: 6.9674
2025-06-10 01:23:27,157 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_bs4_cw12_lr3e-04_latest.pt at step 600
2025-06-10 01:23:29,913 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_bs4_cw12_lr3e-04_best.pt at step 600
2025-06-10 01:23:29,918 - src.training.utils - INFO -  New Best Model (Val: 6.9674)
2025-06-10 01:23:51,531 - src.training.utils - INFO - [Step 700/1000] Train: 6.0199, Val: 7.8348
2025-06-10 01:23:54,361 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_bs4_cw12_lr3e-04_latest.pt at step 700
2025-06-10 01:23:54,362 - src.training.utils - INFO -  No improvement: 1/50
2025-06-10 01:24:17,522 - src.training.utils - INFO - [Step 800/1000] Train: 8.2129, Val: 7.5646
2025-06-10 01:24:20,333 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_bs4_cw12_lr3e-04_latest.pt at step 800
2025-06-10 01:24:20,333 - src.training.utils - INFO -  No improvement: 2/50
2025-06-10 01:24:43,151 - src.training.utils - INFO - [Step 900/1000] Train: 7.3852, Val: 7.2641
2025-06-10 01:24:45,450 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_bs4_cw12_lr3e-04_latest.pt at step 900
2025-06-10 01:24:45,451 - src.training.utils - INFO -  No improvement: 3/50
2025-06-10 01:25:11,148 - src.training.utils - INFO - [Step 1000/1000] Train: 6.8999, Val: 7.1836
2025-06-10 01:25:11,150 - src.training.utils - INFO -  No improvement: 4/50
2025-06-10 01:25:11,151 - src.training.utils - INFO - Training completed at step 1000. Saving final checkpoint.
2025-06-10 01:25:13,735 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_bs4_cw12_lr3e-04_latest.pt at step 1000
2025-06-10 01:25:17,157 - src.training.utils - INFO - Preserved best checkpoint at model_checkpoints/run_single_bs4_cw12_lr3e-04_bs4_cw12_lr3e-04_best.pt.
2025-06-10 01:25:20,102 - src.training.utils - INFO - Loss curve saved to train_eval_plots/loss_run_single_bs4_cw12_lr3e-04_bs4_cw12_lr3e-04.png and logged.
2025-06-10 01:25:20,153 - src.training.manager - INFO - Saved completion status to model_checkpoints/completion_tracking/single_bs4_cw12_lr3e-04_completed.json
2025-06-10 01:25:20,153 - src.training.manager - INFO - Running post-training evaluations...
2025-06-10 01:25:20,375 - src.training.manager - INFO - Loaded best model from model_checkpoints/run_single_bs4_cw12_lr3e-04_bs4_cw12_lr3e-04_best.pt for final eval.
2025-06-10 01:25:21,330 - src.training.manager - INFO - Average Test Set Loss: 7.7289
2025-06-10 01:25:21,367 - src.training.manager - INFO - Logging model artifact from model_checkpoints/run_single_bs4_cw12_lr3e-04_bs4_cw12_lr3e-04_best.pt
2025-06-10 01:25:22,904 - src.training.manager - INFO - Logged artifact: Transformer_e2e_model-single_bs4_cw12_lr3e-04
2025-06-10 01:25:22,904 - src.training.manager - INFO - Waiting for artifact upload to complete (timeout: 300s)...
2025-06-10 01:25:45,006 - src.training.manager - INFO - Artifact upload finished.
2025-06-10 01:25:45,008 - src.training.manager - INFO - Cleaning up local checkpoint files...
2025-06-10 01:25:45,417 - src.training.manager - INFO - Removed checkpoint: model_checkpoints/run_single_bs4_cw12_lr3e-04_bs4_cw12_lr3e-04_latest.pt
2025-06-10 01:25:45,603 - src.training.manager - INFO - Removed checkpoint: model_checkpoints/run_single_bs4_cw12_lr3e-04_bs4_cw12_lr3e-04_best.pt
2025-06-10 01:25:45,603 - src.training.manager - INFO - Training did not complete successfully - preserving checkpoints for resumption.
2025-06-10 01:25:48,487 - src.training.manager - INFO - --- Single Training Run Finished ---
2025-06-10 01:25:48,487 - __main__ - INFO - Training process finished.
2025-06-10 01:26:19,036 - __main__ - INFO - Starting training process with mode: single
2025-06-10 01:26:19,037 - src.data.processing - INFO - Loading wikitext dataset.
2025-06-10 01:26:29,950 - src.data.processing - INFO - Successfully loaded dataset.
2025-06-10 01:26:30,108 - src.data.processing - INFO - Truncated wikitext to 10000000 characters for CPU training.
2025-06-10 01:26:30,108 - src.data.processing - INFO - Loading tokenizer 'gpt2'...
2025-06-10 01:26:31,277 - src.training.manager - INFO - --- Starting Single Training Run ---
2025-06-10 01:26:31,277 - src.training.manager - INFO - Found completion status for run single_bs4_cw12_lr3e-04: all_steps_completed at step 1000
2025-06-10 01:26:31,277 - src.training.manager - INFO - Run single_bs4_cw12_lr3e-04 was already completed. Creating new run with suffix.
2025-06-10 01:26:31,278 - src.training.manager - INFO - Using new run ID: single_bs4_cw12_lr3e-04_2
2025-06-10 01:26:31,278 - src.training.manager - INFO - Starting training run: single_bs4_cw12_lr3e-04_2
2025-06-10 01:26:33,708 - src.training.manager - INFO - Run created at: 2025-06-10 01:26:31
2025-06-10 01:26:33,725 - src.data.processing - INFO - Tokenizing the entire dataset..
2025-06-10 01:26:45,335 - src.data.processing - INFO - Tokenization complete. Total tokens: 2197766
2025-06-10 01:26:45,544 - src.data.processing - INFO - Train tokens: 1780191, Val tokens: 197798, Test tokens: 219777
2025-06-10 01:26:45,599 - src.models.transformer - INFO - Linearly scaling dropout from 0.100 to 0.200 over 3 layers. Result: [0.1, 0.15, 0.2]
2025-06-10 01:26:45,679 - src.training.utils - INFO - No checkpoint found. Starting fresh.
2025-06-10 01:26:47,158 - src.training.utils - INFO - Starting/Resuming training on cpu
2025-06-10 01:27:06,272 - src.training.utils - INFO - [Step 100/1000] Train: 8.1028, Val: 8.3551
2025-06-10 01:27:08,958 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_2_bs4_cw12_lr3e-04_latest.pt at step 100
2025-06-10 01:27:11,813 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_2_bs4_cw12_lr3e-04_best.pt at step 100
2025-06-10 01:27:11,813 - src.training.utils - INFO -  New Best Model (Val: 8.3551)
2025-06-10 01:27:30,481 - src.training.utils - INFO - [Step 200/1000] Train: 8.4340, Val: 7.9515
2025-06-10 01:27:33,045 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_2_bs4_cw12_lr3e-04_latest.pt at step 200
2025-06-10 01:27:35,651 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_2_bs4_cw12_lr3e-04_best.pt at step 200
2025-06-10 01:27:35,652 - src.training.utils - INFO -  New Best Model (Val: 7.9515)
2025-06-10 01:27:53,393 - src.training.utils - INFO - [Step 300/1000] Train: 6.7861, Val: 7.8545
2025-06-10 01:27:55,855 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_2_bs4_cw12_lr3e-04_latest.pt at step 300
2025-06-10 01:27:58,930 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_2_bs4_cw12_lr3e-04_best.pt at step 300
2025-06-10 01:27:58,931 - src.training.utils - INFO -  New Best Model (Val: 7.8545)
2025-06-10 01:28:14,756 - src.training.utils - INFO - [Step 400/1000] Train: 7.6234, Val: 7.7022
2025-06-10 01:28:17,053 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_2_bs4_cw12_lr3e-04_latest.pt at step 400
2025-06-10 01:28:19,806 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_2_bs4_cw12_lr3e-04_best.pt at step 400
2025-06-10 01:28:19,807 - src.training.utils - INFO -  New Best Model (Val: 7.7022)
2025-06-10 01:28:36,046 - src.training.utils - INFO - [Step 500/1000] Train: 7.2629, Val: 7.5064
2025-06-10 01:28:38,378 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_2_bs4_cw12_lr3e-04_latest.pt at step 500
2025-06-10 01:28:40,716 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_2_bs4_cw12_lr3e-04_best.pt at step 500
2025-06-10 01:28:40,716 - src.training.utils - INFO -  New Best Model (Val: 7.5064)
2025-06-10 01:28:57,583 - src.training.utils - INFO - [Step 600/1000] Train: 7.5340, Val: 7.4621
2025-06-10 01:29:00,072 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_2_bs4_cw12_lr3e-04_latest.pt at step 600
2025-06-10 01:29:02,335 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_2_bs4_cw12_lr3e-04_best.pt at step 600
2025-06-10 01:29:02,335 - src.training.utils - INFO -  New Best Model (Val: 7.4621)
2025-06-10 01:29:27,946 - src.training.utils - INFO - [Step 700/1000] Train: 7.3981, Val: 7.5711
2025-06-10 01:29:30,333 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_2_bs4_cw12_lr3e-04_latest.pt at step 700
2025-06-10 01:29:30,333 - src.training.utils - INFO -  No improvement: 1/50
2025-06-10 01:29:59,659 - src.training.utils - INFO - [Step 800/1000] Train: 7.9004, Val: 7.2911
2025-06-10 01:30:03,650 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_2_bs4_cw12_lr3e-04_latest.pt at step 800
2025-06-10 01:30:06,680 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_2_bs4_cw12_lr3e-04_best.pt at step 800
2025-06-10 01:30:06,681 - src.training.utils - INFO -  New Best Model (Val: 7.2911)
2025-06-10 01:30:31,097 - src.training.utils - INFO - [Step 900/1000] Train: 7.3859, Val: 7.3401
2025-06-10 01:30:33,787 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_2_bs4_cw12_lr3e-04_latest.pt at step 900
2025-06-10 01:30:33,788 - src.training.utils - INFO -  No improvement: 1/50
2025-06-10 01:30:57,486 - src.training.utils - INFO - [Step 1000/1000] Train: 7.3225, Val: 7.8083
2025-06-10 01:30:57,488 - src.training.utils - INFO -  No improvement: 2/50
2025-06-10 01:30:57,489 - src.training.utils - INFO - Training completed at step 1000. Saving final checkpoint.
2025-06-10 01:31:00,478 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs4_cw12_lr3e-04_2_bs4_cw12_lr3e-04_latest.pt at step 1000
2025-06-10 01:31:03,765 - src.training.utils - INFO - Preserved best checkpoint at model_checkpoints/run_single_bs4_cw12_lr3e-04_2_bs4_cw12_lr3e-04_best.pt.
2025-06-10 01:31:06,465 - src.training.utils - INFO - Loss curve saved to train_eval_plots/loss_run_single_bs4_cw12_lr3e-04_2_bs4_cw12_lr3e-04.png and logged.
2025-06-10 01:31:06,498 - src.training.manager - INFO - Saved completion status to model_checkpoints/completion_tracking/single_bs4_cw12_lr3e-04_2_completed.json
2025-06-10 01:31:06,499 - src.training.manager - INFO - Running post-training evaluations...
2025-06-10 01:31:06,618 - src.training.manager - INFO - Loaded best model from model_checkpoints/run_single_bs4_cw12_lr3e-04_2_bs4_cw12_lr3e-04_best.pt for final eval.
2025-06-10 01:31:07,380 - src.training.manager - INFO - Average Test Set Loss: 7.6035
2025-06-10 01:31:07,407 - src.training.manager - INFO - Logging model artifact from model_checkpoints/run_single_bs4_cw12_lr3e-04_2_bs4_cw12_lr3e-04_best.pt
2025-06-10 01:31:10,077 - src.training.manager - INFO - Logged artifact: Transformer_e2e_model-single_bs4_cw12_lr3e-04_2
2025-06-10 01:31:10,078 - src.training.manager - INFO - Waiting for artifact upload to complete (timeout: 300s)...
2025-06-10 01:31:30,024 - src.training.manager - INFO - Artifact upload finished.
2025-06-10 01:31:30,025 - src.training.manager - INFO - Cleaning up local checkpoint files...
2025-06-10 01:31:30,310 - src.training.manager - INFO - Removed checkpoint: model_checkpoints/run_single_bs4_cw12_lr3e-04_2_bs4_cw12_lr3e-04_latest.pt
2025-06-10 01:31:30,529 - src.training.manager - INFO - Removed checkpoint: model_checkpoints/run_single_bs4_cw12_lr3e-04_2_bs4_cw12_lr3e-04_best.pt
2025-06-10 01:31:30,529 - src.training.manager - INFO - Training did not complete successfully - preserving checkpoints for resumption.
2025-06-10 01:31:33,346 - src.training.manager - INFO - --- Single Training Run Finished ---
2025-06-10 01:31:33,346 - __main__ - INFO - Training process finished.
2025-06-10 01:37:13,204 - __main__ - INFO - Starting training process with mode: single
2025-06-10 01:37:13,204 - src.data.processing - INFO - Loading wikitext dataset.
2025-06-10 01:37:26,192 - src.data.processing - INFO - Successfully loaded dataset.
2025-06-10 01:37:26,354 - src.data.processing - INFO - Truncated wikitext to 10000000 characters for CPU training.
2025-06-10 01:37:26,354 - src.data.processing - INFO - Loading tokenizer 'gpt2'...
2025-06-10 01:37:27,317 - src.training.manager - INFO - --- Starting Single Training Run ---
2025-06-10 01:37:27,318 - src.training.manager - INFO - No previous data for single_bs12_cw16_lr3e-04. Starting fresh training.
2025-06-10 01:37:27,318 - src.training.manager - INFO - Starting training run: single_bs12_cw16_lr3e-04
2025-06-10 01:37:30,034 - src.training.manager - INFO - Run created at: 2025-06-10 01:37:27
2025-06-10 01:37:30,054 - src.data.processing - INFO - Tokenizing the entire dataset..
2025-06-10 01:37:44,366 - src.data.processing - INFO - Tokenization complete. Total tokens: 2197766
2025-06-10 01:37:44,568 - src.data.processing - INFO - Train tokens: 1780191, Val tokens: 197798, Test tokens: 219777
2025-06-10 01:37:44,626 - src.models.transformer - INFO - Linearly scaling dropout from 0.100 to 0.200 over 3 layers. Result: [0.1, 0.15, 0.2]
2025-06-10 01:37:44,714 - src.training.utils - INFO - No checkpoint found. Starting fresh.
2025-06-10 01:37:46,469 - src.training.utils - INFO - Starting/Resuming training on cpu
2025-06-10 01:38:24,008 - src.training.utils - INFO - [Step 100/1000] Train: 7.9483, Val: 7.9219
2025-06-10 01:38:26,386 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_bs12_cw16_lr3e-04_latest.pt at step 100
2025-06-10 01:38:29,524 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_bs12_cw16_lr3e-04_best.pt at step 100
2025-06-10 01:38:29,525 - src.training.utils - INFO -  New Best Model (Val: 7.9219)
2025-06-10 01:39:06,311 - src.training.utils - INFO - [Step 200/1000] Train: 7.6857, Val: 7.7457
2025-06-10 01:39:08,875 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_bs12_cw16_lr3e-04_latest.pt at step 200
2025-06-10 01:39:11,787 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_bs12_cw16_lr3e-04_best.pt at step 200
2025-06-10 01:39:11,787 - src.training.utils - INFO -  New Best Model (Val: 7.7457)
2025-06-10 01:39:48,155 - src.training.utils - INFO - [Step 300/1000] Train: 7.5754, Val: 7.5066
2025-06-10 01:39:50,906 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_bs12_cw16_lr3e-04_latest.pt at step 300
2025-06-10 01:39:53,453 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_bs12_cw16_lr3e-04_best.pt at step 300
2025-06-10 01:39:53,453 - src.training.utils - INFO -  New Best Model (Val: 7.5066)
2025-06-10 01:40:31,418 - src.training.utils - INFO - [Step 400/1000] Train: 7.1678, Val: 7.3407
2025-06-10 01:40:34,965 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_bs12_cw16_lr3e-04_latest.pt at step 400
2025-06-10 01:40:38,304 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_bs12_cw16_lr3e-04_best.pt at step 400
2025-06-10 01:40:38,305 - src.training.utils - INFO -  New Best Model (Val: 7.3407)
2025-06-10 01:40:47,235 - __main__ - INFO - Training process finished.
2025-06-10 01:41:10,801 - __main__ - INFO - Starting training process with mode: single
2025-06-10 01:41:10,801 - src.data.processing - INFO - Loading wikitext dataset.
2025-06-10 01:41:22,437 - src.data.processing - INFO - Successfully loaded dataset.
2025-06-10 01:41:22,604 - src.data.processing - INFO - Truncated wikitext to 10000000 characters for CPU training.
2025-06-10 01:41:22,604 - src.data.processing - INFO - Loading tokenizer 'gpt2'...
2025-06-10 01:41:23,681 - src.training.manager - INFO - --- Starting Single Training Run ---
2025-06-10 01:41:23,681 - src.training.manager - INFO - Found checkpoints for incomplete run single_bs12_cw16_lr3e-04. Resuming interrupted training.
2025-06-10 01:41:23,682 - src.training.manager - INFO - Resuming training run: single_bs12_cw16_lr3e-04
2025-06-10 01:41:26,210 - src.training.manager - INFO - Run created at: 2025-06-10 01:41:23
2025-06-10 01:41:26,227 - src.data.processing - INFO - Tokenizing the entire dataset..
2025-06-10 01:41:39,576 - src.data.processing - INFO - Tokenization complete. Total tokens: 2197766
2025-06-10 01:41:39,779 - src.data.processing - INFO - Train tokens: 1780191, Val tokens: 197798, Test tokens: 219777
2025-06-10 01:41:39,836 - src.models.transformer - INFO - Linearly scaling dropout from 0.100 to 0.200 over 3 layers. Result: [0.1, 0.15, 0.2]
2025-06-10 01:41:39,918 - src.training.utils - INFO - Found checkpoint: model_checkpoints/run_single_bs12_cw16_lr3e-04_bs12_cw16_lr3e-04_latest.pt. Attempting to resume.
2025-06-10 01:41:40,321 - src.training.utils - INFO - Resuming from step 401 with best_val_loss 7.5066
2025-06-10 01:41:41,888 - src.training.utils - INFO - Starting/Resuming training on cpu
2025-06-10 01:41:41,890 - src.training.utils - INFO - Loaded optimizer state from checkpoint.
2025-06-10 01:42:19,783 - src.training.utils - INFO - [Step 500/1000] Train: 7.3485, Val: 7.3030
2025-06-10 01:42:22,315 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_bs12_cw16_lr3e-04_latest.pt at step 500
2025-06-10 01:42:24,889 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_bs12_cw16_lr3e-04_best.pt at step 500
2025-06-10 01:42:24,890 - src.training.utils - INFO -  New Best Model (Val: 7.3030)
2025-06-10 01:43:03,801 - src.training.utils - INFO - [Step 600/1000] Train: 6.7755, Val: 7.3734
2025-06-10 01:43:06,261 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_bs12_cw16_lr3e-04_latest.pt at step 600
2025-06-10 01:43:06,262 - src.training.utils - INFO -  No improvement: 1/50
2025-06-10 01:43:46,580 - src.training.utils - INFO - [Step 700/1000] Train: 7.0824, Val: 7.3183
2025-06-10 01:43:51,294 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_bs12_cw16_lr3e-04_latest.pt at step 700
2025-06-10 01:43:51,294 - src.training.utils - INFO -  No improvement: 2/50
2025-06-10 01:44:42,112 - src.training.utils - INFO - [Step 800/1000] Train: 7.4746, Val: 7.2853
2025-06-10 01:44:47,573 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_bs12_cw16_lr3e-04_latest.pt at step 800
2025-06-10 01:44:54,107 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_bs12_cw16_lr3e-04_best.pt at step 800
2025-06-10 01:44:54,108 - src.training.utils - INFO -  New Best Model (Val: 7.2853)
2025-06-10 01:46:05,490 - src.training.utils - INFO - [Step 900/1000] Train: 6.5296, Val: 6.9918
2025-06-10 01:46:09,064 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_bs12_cw16_lr3e-04_latest.pt at step 900
2025-06-10 01:46:12,522 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_bs12_cw16_lr3e-04_best.pt at step 900
2025-06-10 01:46:12,524 - src.training.utils - INFO -  New Best Model (Val: 6.9918)
2025-06-10 01:46:57,906 - src.training.utils - INFO - [Step 1000/1000] Train: 6.3959, Val: 7.0921
2025-06-10 01:46:57,906 - src.training.utils - INFO -  No improvement: 1/50
2025-06-10 01:46:57,907 - src.training.utils - INFO - Training completed at step 1000. Saving final checkpoint.
2025-06-10 01:47:00,999 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_bs12_cw16_lr3e-04_latest.pt at step 1000
2025-06-10 01:47:04,203 - src.training.utils - INFO - Preserved best checkpoint at model_checkpoints/run_single_bs12_cw16_lr3e-04_bs12_cw16_lr3e-04_best.pt.
2025-06-10 01:47:05,986 - src.training.utils - INFO - Loss curve saved to train_eval_plots/loss_run_single_bs12_cw16_lr3e-04_bs12_cw16_lr3e-04.png and logged.
2025-06-10 01:47:06,030 - src.training.manager - INFO - Saved completion status to model_checkpoints/completion_tracking/single_bs12_cw16_lr3e-04_completed.json
2025-06-10 01:47:06,030 - src.training.manager - INFO - Running post-training evaluations...
2025-06-10 01:47:06,150 - src.training.manager - INFO - Loaded best model from model_checkpoints/run_single_bs12_cw16_lr3e-04_bs12_cw16_lr3e-04_best.pt for final eval.
2025-06-10 01:47:07,699 - src.training.manager - INFO - Average Test Set Loss: 7.2841
2025-06-10 01:47:07,740 - src.training.manager - INFO - Logging model artifact from model_checkpoints/run_single_bs12_cw16_lr3e-04_bs12_cw16_lr3e-04_best.pt
2025-06-10 01:47:09,509 - src.training.manager - INFO - Logged artifact: Transformer_e2e_model-single_bs12_cw16_lr3e-04
2025-06-10 01:47:09,510 - src.training.manager - INFO - Waiting for artifact upload to complete (timeout: 300s)...
2025-06-10 01:47:30,316 - src.training.manager - INFO - Artifact upload finished.
2025-06-10 01:47:30,318 - src.training.manager - INFO - Cleaning up local checkpoint files...
2025-06-10 01:47:30,513 - src.training.manager - INFO - Removed checkpoint: model_checkpoints/run_single_bs12_cw16_lr3e-04_bs12_cw16_lr3e-04_latest.pt
2025-06-10 01:47:30,707 - src.training.manager - INFO - Removed checkpoint: model_checkpoints/run_single_bs12_cw16_lr3e-04_bs12_cw16_lr3e-04_best.pt
2025-06-10 01:47:30,708 - src.training.manager - INFO - Training did not complete successfully - preserving checkpoints for resumption.
2025-06-10 01:47:33,526 - src.training.manager - INFO - --- Single Training Run Finished ---
2025-06-10 01:47:33,526 - __main__ - INFO - Training process finished.
2025-06-10 02:19:27,970 - __main__ - INFO - Starting training process with mode: single
2025-06-10 02:19:27,970 - src.data.processing - INFO - Loading wikitext dataset.
2025-06-10 02:19:39,957 - src.data.processing - INFO - Successfully loaded dataset.
2025-06-10 02:19:40,169 - src.data.processing - INFO - Truncated wikitext to 10000000 characters for CPU training.
2025-06-10 02:19:40,169 - src.data.processing - INFO - Loading tokenizer 'gpt2'...
2025-06-10 02:19:41,247 - src.training.manager - INFO - --- Starting Single Training Run ---
2025-06-10 02:19:41,248 - src.training.manager - INFO - Found completion status for run single_bs12_cw16_lr3e-04: all_steps_completed at step 1000
2025-06-10 02:19:41,248 - src.training.manager - INFO - Run single_bs12_cw16_lr3e-04 was already completed. Creating new run with suffix.
2025-06-10 02:19:41,250 - src.training.manager - INFO - Using new run ID: single_bs12_cw16_lr3e-04_2
2025-06-10 02:19:41,250 - src.training.manager - INFO - Starting training run: single_bs12_cw16_lr3e-04_2
2025-06-10 02:19:43,983 - src.training.manager - INFO - Run created at: 2025-06-10 02:19:41
2025-06-10 02:19:44,007 - src.data.processing - INFO - Tokenizing the entire dataset..
2025-06-10 02:19:59,559 - src.data.processing - INFO - Tokenization complete. Total tokens: 2197766
2025-06-10 02:19:59,819 - src.data.processing - INFO - Train tokens: 1780191, Val tokens: 197798, Test tokens: 219777
2025-06-10 02:19:59,887 - src.models.transformer - INFO - Linearly scaling dropout from 0.100 to 0.200 over 3 layers. Result: [0.1, 0.15, 0.2]
2025-06-10 02:19:59,981 - src.training.utils - INFO - No checkpoint found. Starting fresh.
2025-06-10 02:20:01,666 - src.training.utils - INFO - Starting/Resuming training on cpu
2025-06-10 02:20:47,174 - src.training.utils - INFO - [Step 100/1000] Train: 8.2037, Val: 7.8934
2025-06-10 02:20:50,202 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_2_bs12_cw16_lr3e-04_latest.pt at step 100
2025-06-10 02:20:54,565 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_2_bs12_cw16_lr3e-04_best.pt at step 100
2025-06-10 02:20:54,570 - src.training.utils - INFO -  New Best Model (Val: 7.8934)
2025-06-10 02:21:41,019 - src.training.utils - INFO - [Step 200/1000] Train: 7.6226, Val: 7.7728
2025-06-10 02:21:43,612 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_2_bs12_cw16_lr3e-04_latest.pt at step 200
2025-06-10 02:21:46,780 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_2_bs12_cw16_lr3e-04_best.pt at step 200
2025-06-10 02:21:46,780 - src.training.utils - INFO -  New Best Model (Val: 7.7728)
2025-06-10 02:22:38,338 - src.training.utils - INFO - [Step 300/1000] Train: 7.4366, Val: 7.7651
2025-06-10 02:22:41,439 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_2_bs12_cw16_lr3e-04_latest.pt at step 300
2025-06-10 02:22:45,152 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_2_bs12_cw16_lr3e-04_best.pt at step 300
2025-06-10 02:22:45,152 - src.training.utils - INFO -  New Best Model (Val: 7.7651)
2025-06-10 02:23:27,063 - src.training.utils - INFO - [Step 400/1000] Train: 7.2772, Val: 7.4487
2025-06-10 02:23:29,608 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_2_bs12_cw16_lr3e-04_latest.pt at step 400
2025-06-10 02:23:32,589 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_2_bs12_cw16_lr3e-04_best.pt at step 400
2025-06-10 02:23:32,589 - src.training.utils - INFO -  New Best Model (Val: 7.4487)
2025-06-10 02:24:14,787 - src.training.utils - INFO - [Step 500/1000] Train: 7.0381, Val: 7.2633
2025-06-10 02:24:17,267 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_2_bs12_cw16_lr3e-04_latest.pt at step 500
2025-06-10 02:24:20,789 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_2_bs12_cw16_lr3e-04_best.pt at step 500
2025-06-10 02:24:20,793 - src.training.utils - INFO -  New Best Model (Val: 7.2633)
2025-06-10 02:24:59,125 - src.training.utils - INFO - [Step 600/1000] Train: 6.9218, Val: 7.1999
2025-06-10 02:25:01,531 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_2_bs12_cw16_lr3e-04_latest.pt at step 600
2025-06-10 02:25:04,369 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_2_bs12_cw16_lr3e-04_best.pt at step 600
2025-06-10 02:25:04,369 - src.training.utils - INFO -  New Best Model (Val: 7.1999)
2025-06-10 02:26:02,344 - src.training.utils - INFO - [Step 700/1000] Train: 6.6653, Val: 7.3149
2025-06-10 02:26:06,661 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_2_bs12_cw16_lr3e-04_latest.pt at step 700
2025-06-10 02:26:06,661 - src.training.utils - INFO -  No improvement: 1/50
2025-06-10 02:27:24,339 - src.training.utils - INFO - [Step 800/1000] Train: 7.1145, Val: 7.3178
2025-06-10 02:27:27,928 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_2_bs12_cw16_lr3e-04_latest.pt at step 800
2025-06-10 02:27:27,929 - src.training.utils - INFO -  No improvement: 2/50
2025-06-10 02:28:14,665 - src.training.utils - INFO - [Step 900/1000] Train: 6.9868, Val: 7.1215
2025-06-10 02:28:18,251 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_2_bs12_cw16_lr3e-04_latest.pt at step 900
2025-06-10 02:28:21,741 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_2_bs12_cw16_lr3e-04_best.pt at step 900
2025-06-10 02:28:21,742 - src.training.utils - INFO -  New Best Model (Val: 7.1215)
2025-06-10 02:29:17,470 - src.training.utils - INFO - [Step 1000/1000] Train: 6.8542, Val: 7.0851
2025-06-10 02:29:21,243 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_2_bs12_cw16_lr3e-04_best.pt at step 1000
2025-06-10 02:29:21,244 - src.training.utils - INFO -  New Best Model (Val: 7.0851)
2025-06-10 02:29:21,247 - src.training.utils - INFO - Training completed at step 1000. Saving final checkpoint.
2025-06-10 02:29:24,843 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-04_2_bs12_cw16_lr3e-04_latest.pt at step 1000
2025-06-10 02:29:32,000 - src.training.utils - INFO - Preserved best checkpoint at model_checkpoints/run_single_bs12_cw16_lr3e-04_2_bs12_cw16_lr3e-04_best.pt.
2025-06-10 02:29:35,330 - src.training.utils - INFO - Loss curve saved to train_eval_plots/loss_run_single_bs12_cw16_lr3e-04_2_bs12_cw16_lr3e-04.png and logged.
2025-06-10 02:29:35,387 - src.training.manager - INFO - Saved completion status to model_checkpoints/completion_tracking/single_bs12_cw16_lr3e-04_2_completed.json
2025-06-10 02:29:35,387 - src.training.manager - INFO - Running post-training evaluations...
2025-06-10 02:29:35,606 - src.training.manager - INFO - Loaded best model from model_checkpoints/run_single_bs12_cw16_lr3e-04_2_bs12_cw16_lr3e-04_best.pt for final eval.
2025-06-10 02:29:37,753 - src.training.manager - INFO - Average Test Set Loss: 7.1718
2025-06-10 02:29:37,791 - src.training.manager - INFO - Logging model artifact from model_checkpoints/run_single_bs12_cw16_lr3e-04_2_bs12_cw16_lr3e-04_best.pt
2025-06-10 02:29:39,696 - src.training.manager - INFO - Logged artifact: Transformer_e2e_model-single_bs12_cw16_lr3e-04_2
2025-06-10 02:29:39,697 - src.training.manager - INFO - Waiting for artifact upload to complete (timeout: 300s)...
2025-06-10 02:30:00,680 - src.training.manager - INFO - Artifact upload finished.
2025-06-10 02:30:00,683 - src.training.manager - INFO - Cleaning up local checkpoint files...
2025-06-10 02:30:00,829 - src.training.manager - INFO - Removed checkpoint: model_checkpoints/run_single_bs12_cw16_lr3e-04_2_bs12_cw16_lr3e-04_latest.pt
2025-06-10 02:30:00,986 - src.training.manager - INFO - Removed checkpoint: model_checkpoints/run_single_bs12_cw16_lr3e-04_2_bs12_cw16_lr3e-04_best.pt
2025-06-10 02:30:00,987 - src.training.manager - INFO - Training did not complete successfully - preserving checkpoints for resumption.
2025-06-10 02:30:04,053 - src.training.manager - INFO - --- Single Training Run Finished ---
2025-06-10 02:30:04,053 - __main__ - INFO - Training process finished.
2025-06-10 02:38:32,128 - __main__ - INFO - Starting training process with mode: sweep
2025-06-10 02:38:32,129 - __main__ - INFO - Hyperparameter tuning is disabled in config or mode doesn't match. Exiting.
2025-06-10 02:38:32,130 - __main__ - INFO - Training process finished.
2025-06-10 02:40:42,460 - __main__ - INFO - Starting training process with mode: sweep
2025-06-10 02:40:42,460 - src.data.processing - INFO - Loading wikitext dataset.
2025-06-10 02:40:54,430 - src.data.processing - INFO - Successfully loaded dataset.
2025-06-10 02:40:54,661 - src.data.processing - INFO - Truncated wikitext to 10000000 characters for CPU training.
2025-06-10 02:40:54,662 - src.data.processing - INFO - Loading tokenizer 'gpt2'...
2025-06-10 02:40:55,919 - src.training.manager - INFO - --- Starting Hyperparameter Search ---
2025-06-10 02:40:55,920 - src.training.manager - INFO - Hyperparameter sweep started at: 20250610_0240
2025-06-10 02:40:55,921 - __main__ - CRITICAL - Unhandled error in single run: Unknown format code 'e' for object of type 'str'
Traceback (most recent call last):
  File "/Users/kritiagrawal/Desktop/job_practice/ml_engineering/transformer_e2e/scripts/train.py", line 75, in main
    run_hyperparameter_search(raw_text, tokenizer, cfg)
  File "/Users/kritiagrawal/Desktop/job_practice/ml_engineering/transformer_e2e/src/training/manager.py", line 655, in run_hyperparameter_search
    base_run_id = f"tune_bs{bs}_cw{cw}_lr{lr:.0e}"
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Unknown format code 'e' for object of type 'str'
2025-06-10 02:40:55,924 - __main__ - INFO - Training process finished.
2025-06-10 02:45:27,039 - __main__ - INFO - Starting training process with mode: sweep
2025-06-10 02:45:27,039 - src.data.processing - INFO - Loading wikitext dataset.
2025-06-10 02:45:38,121 - src.data.processing - INFO - Successfully loaded dataset.
2025-06-10 02:45:38,404 - src.data.processing - INFO - Truncated wikitext to 10000000 characters for CPU training.
2025-06-10 02:45:38,404 - src.data.processing - INFO - Loading tokenizer 'gpt2'...
2025-06-10 02:45:39,670 - src.training.manager - INFO - --- Starting Hyperparameter Search ---
2025-06-10 02:45:39,670 - src.training.manager - INFO - Hyperparameter sweep started at: 20250610_0245
2025-06-10 02:45:39,672 - src.training.manager - INFO - No previous data for tune_bs8_cw32_lr3e-04. Starting fresh training.
2025-06-10 02:45:39,673 - src.training.manager - INFO - Starting Tuning Run: transformer_e2e_sweep__tune_bs8_cw32_lr3e-04 (new)
2025-06-10 02:45:39,674 - src.training.manager - INFO - Starting training run: tune_bs8_cw32_lr3e-04
2025-06-10 02:45:42,425 - src.training.manager - INFO - Run created at: 2025-06-10 02:45:39
2025-06-10 02:45:42,426 - src.training.manager - INFO - Starting fresh - Python 3.11.8
2025-06-10 02:45:42,453 - src.data.processing - INFO - Tokenizing the entire dataset..
2025-06-10 02:45:58,322 - src.data.processing - INFO - Tokenization complete. Total tokens: 2197766
2025-06-10 02:45:58,544 - src.data.processing - INFO - Train tokens: 1780191, Val tokens: 197798, Test tokens: 219777
2025-06-10 02:45:58,611 - src.models.transformer - INFO - Linearly scaling dropout from 0.100 to 0.200 over 3 layers. Result: [0.1, 0.15, 0.2]
2025-06-10 02:45:58,711 - src.training.utils - INFO - No checkpoint found. Starting fresh.
2025-06-10 02:46:00,307 - src.training.utils - INFO - Starting/Resuming training on cpu
2025-06-10 02:46:13,178 - src.training.utils - INFO - [Step 25/5000] Train: 10.0284, Val: 9.9466
2025-06-10 02:46:16,120 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 25
2025-06-10 02:46:19,735 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_best.pt at step 25
2025-06-10 02:46:19,736 - src.training.utils - INFO -  New Best Model (Val: 9.9466)
2025-06-10 02:46:34,339 - src.training.utils - INFO - [Step 50/5000] Train: 9.0420, Val: 8.9280
2025-06-10 02:46:37,213 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 50
2025-06-10 02:46:40,700 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_best.pt at step 50
2025-06-10 02:46:40,705 - src.training.utils - INFO -  New Best Model (Val: 8.9280)
2025-06-10 02:46:50,113 - src.training.utils - INFO - [Step 75/5000] Train: 8.1527, Val: 8.2973
2025-06-10 02:46:52,723 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 75
2025-06-10 02:46:55,331 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_best.pt at step 75
2025-06-10 02:46:55,331 - src.training.utils - INFO -  New Best Model (Val: 8.2973)
2025-06-10 02:47:13,263 - src.training.utils - INFO - [Step 100/5000] Train: 7.8460, Val: 7.9395
2025-06-10 02:47:19,583 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 100
2025-06-10 02:47:25,905 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_best.pt at step 100
2025-06-10 02:47:25,907 - src.training.utils - INFO -  New Best Model (Val: 7.9395)
2025-06-10 02:47:53,460 - src.training.utils - INFO - [Step 125/5000] Train: 7.7695, Val: 7.7660
2025-06-10 02:47:58,025 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 125
2025-06-10 02:48:02,862 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_best.pt at step 125
2025-06-10 02:48:02,864 - src.training.utils - INFO -  New Best Model (Val: 7.7660)
2025-06-10 02:48:32,051 - src.training.utils - INFO - [Step 150/5000] Train: 8.0283, Val: 7.7023
2025-06-10 02:48:35,252 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 150
2025-06-10 02:48:39,362 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_best.pt at step 150
2025-06-10 02:48:39,363 - src.training.utils - INFO -  New Best Model (Val: 7.7023)
2025-06-10 02:48:54,455 - src.training.utils - INFO - [Step 175/5000] Train: 7.1964, Val: 7.7778
2025-06-10 02:48:59,755 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 175
2025-06-10 02:48:59,755 - src.training.utils - INFO -  No improvement: 1/10
2025-06-10 02:49:14,496 - src.training.utils - INFO - [Step 200/5000] Train: 7.5795, Val: 7.7395
2025-06-10 02:49:17,477 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 200
2025-06-10 02:49:17,477 - src.training.utils - INFO -  No improvement: 2/10
2025-06-10 02:49:30,349 - src.training.utils - INFO - [Step 225/5000] Train: 7.2116, Val: 7.6425
2025-06-10 02:49:33,464 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 225
2025-06-10 02:49:36,579 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_best.pt at step 225
2025-06-10 02:49:36,580 - src.training.utils - INFO -  New Best Model (Val: 7.6425)
2025-06-10 02:49:50,222 - src.training.utils - INFO - [Step 250/5000] Train: 8.2580, Val: 7.6154
2025-06-10 02:49:52,881 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 250
2025-06-10 02:49:55,909 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_best.pt at step 250
2025-06-10 02:49:55,910 - src.training.utils - INFO -  New Best Model (Val: 7.6154)
2025-06-10 02:50:08,964 - src.training.utils - INFO - [Step 275/5000] Train: 7.6412, Val: 7.5834
2025-06-10 02:50:11,939 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 275
2025-06-10 02:50:14,956 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_best.pt at step 275
2025-06-10 02:50:14,957 - src.training.utils - INFO -  New Best Model (Val: 7.5834)
2025-06-10 02:50:27,899 - src.training.utils - INFO - [Step 300/5000] Train: 7.0280, Val: 7.4566
2025-06-10 02:50:30,534 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 300
2025-06-10 02:50:33,472 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_best.pt at step 300
2025-06-10 02:50:33,473 - src.training.utils - INFO -  New Best Model (Val: 7.4566)
2025-06-10 02:50:46,148 - src.training.utils - INFO - [Step 325/5000] Train: 7.3027, Val: 7.3379
2025-06-10 02:50:49,596 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 325
2025-06-10 02:50:53,127 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_best.pt at step 325
2025-06-10 02:50:53,127 - src.training.utils - INFO -  New Best Model (Val: 7.3379)
2025-06-10 02:51:05,639 - src.training.utils - INFO - [Step 350/5000] Train: 7.1618, Val: 7.4356
2025-06-10 02:51:08,839 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 350
2025-06-10 02:51:08,840 - src.training.utils - INFO -  No improvement: 1/10
2025-06-10 02:51:20,971 - src.training.utils - INFO - [Step 375/5000] Train: 7.5447, Val: 7.5828
2025-06-10 02:51:23,801 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 375
2025-06-10 02:51:23,801 - src.training.utils - INFO -  No improvement: 2/10
2025-06-10 02:51:35,864 - src.training.utils - INFO - [Step 400/5000] Train: 7.4797, Val: 7.5208
2025-06-10 02:51:38,857 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 400
2025-06-10 02:51:38,857 - src.training.utils - INFO -  No improvement: 3/10
2025-06-10 02:51:50,660 - src.training.utils - INFO - [Step 425/5000] Train: 6.9142, Val: 7.3825
2025-06-10 02:51:53,351 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 425
2025-06-10 02:51:53,352 - src.training.utils - INFO -  No improvement: 4/10
2025-06-10 02:52:06,070 - src.training.utils - INFO - [Step 450/5000] Train: 7.4145, Val: 7.2387
2025-06-10 02:52:09,185 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 450
2025-06-10 02:52:12,186 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_best.pt at step 450
2025-06-10 02:52:12,188 - src.training.utils - INFO -  New Best Model (Val: 7.2387)
2025-06-10 02:52:24,096 - src.training.utils - INFO - [Step 475/5000] Train: 7.1554, Val: 7.3170
2025-06-10 02:52:26,608 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 475
2025-06-10 02:52:26,609 - src.training.utils - INFO -  No improvement: 1/10
2025-06-10 02:52:39,992 - src.training.utils - INFO - [Step 500/5000] Train: 7.0430, Val: 7.2512
2025-06-10 02:52:42,806 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 500
2025-06-10 02:52:42,807 - src.training.utils - INFO -  No improvement: 2/10
2025-06-10 02:52:54,662 - src.training.utils - INFO - [Step 525/5000] Train: 7.3216, Val: 7.4111
2025-06-10 02:52:57,252 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 525
2025-06-10 02:52:57,253 - src.training.utils - INFO -  No improvement: 3/10
2025-06-10 02:53:09,953 - src.training.utils - INFO - [Step 550/5000] Train: 7.1512, Val: 7.1932
2025-06-10 02:53:12,783 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 550
2025-06-10 02:53:15,710 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_best.pt at step 550
2025-06-10 02:53:15,718 - src.training.utils - INFO -  New Best Model (Val: 7.1932)
2025-06-10 02:53:27,435 - src.training.utils - INFO - [Step 575/5000] Train: 7.1472, Val: 7.3172
2025-06-10 02:53:31,721 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 575
2025-06-10 02:53:31,722 - src.training.utils - INFO -  No improvement: 1/10
2025-06-10 02:53:44,614 - src.training.utils - INFO - [Step 600/5000] Train: 6.9375, Val: 7.2553
2025-06-10 02:53:47,113 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 600
2025-06-10 02:53:47,114 - src.training.utils - INFO -  No improvement: 2/10
2025-06-10 02:53:58,750 - src.training.utils - INFO - [Step 625/5000] Train: 7.2121, Val: 7.3486
2025-06-10 02:54:01,437 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 625
2025-06-10 02:54:01,438 - src.training.utils - INFO -  No improvement: 3/10
2025-06-10 02:54:15,367 - src.training.utils - INFO - [Step 650/5000] Train: 7.1629, Val: 7.3352
2025-06-10 02:54:18,958 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 650
2025-06-10 02:54:18,959 - src.training.utils - INFO -  No improvement: 4/10
2025-06-10 02:54:32,948 - src.training.utils - INFO - [Step 675/5000] Train: 6.9902, Val: 7.1341
2025-06-10 02:54:35,662 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 675
2025-06-10 02:54:39,441 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_best.pt at step 675
2025-06-10 02:54:39,446 - src.training.utils - INFO -  New Best Model (Val: 7.1341)
2025-06-10 02:54:55,916 - src.training.utils - INFO - [Step 700/5000] Train: 7.4682, Val: 7.2383
2025-06-10 02:54:59,152 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 700
2025-06-10 02:54:59,153 - src.training.utils - INFO -  No improvement: 1/10
2025-06-10 02:55:13,915 - src.training.utils - INFO - [Step 725/5000] Train: 7.1941, Val: 7.3221
2025-06-10 02:55:17,405 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 725
2025-06-10 02:55:17,406 - src.training.utils - INFO -  No improvement: 2/10
2025-06-10 02:55:33,770 - src.training.utils - INFO - [Step 750/5000] Train: 7.0585, Val: 7.2455
2025-06-10 02:55:36,919 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 750
2025-06-10 02:55:36,919 - src.training.utils - INFO -  No improvement: 3/10
2025-06-10 02:55:49,853 - src.training.utils - INFO - [Step 775/5000] Train: 6.7041, Val: 7.3499
2025-06-10 02:55:52,689 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 775
2025-06-10 02:55:52,690 - src.training.utils - INFO -  No improvement: 4/10
2025-06-10 02:56:04,593 - src.training.utils - INFO - [Step 800/5000] Train: 7.0940, Val: 7.0614
2025-06-10 02:56:07,822 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 800
2025-06-10 02:56:10,837 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_best.pt at step 800
2025-06-10 02:56:10,838 - src.training.utils - INFO -  New Best Model (Val: 7.0614)
2025-06-10 02:56:22,619 - src.training.utils - INFO - [Step 825/5000] Train: 6.5483, Val: 7.1319
2025-06-10 02:56:25,766 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 825
2025-06-10 02:56:25,766 - src.training.utils - INFO -  No improvement: 1/10
2025-06-10 02:56:38,715 - src.training.utils - INFO - [Step 850/5000] Train: 6.9388, Val: 7.0841
2025-06-10 02:56:41,650 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 850
2025-06-10 02:56:41,651 - src.training.utils - INFO -  No improvement: 2/10
2025-06-10 02:56:53,213 - src.training.utils - INFO - [Step 875/5000] Train: 7.1755, Val: 7.0088
2025-06-10 02:56:55,847 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 875
2025-06-10 02:56:58,688 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_best.pt at step 875
2025-06-10 02:56:58,689 - src.training.utils - INFO -  New Best Model (Val: 7.0088)
2025-06-10 02:57:11,210 - src.training.utils - INFO - [Step 900/5000] Train: 7.5844, Val: 7.2648
2025-06-10 02:57:14,084 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 900
2025-06-10 02:57:14,084 - src.training.utils - INFO -  No improvement: 1/10
2025-06-10 02:57:25,759 - src.training.utils - INFO - [Step 925/5000] Train: 7.1532, Val: 7.2598
2025-06-10 02:57:28,555 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 925
2025-06-10 02:57:28,555 - src.training.utils - INFO -  No improvement: 2/10
2025-06-10 02:57:41,689 - src.training.utils - INFO - [Step 950/5000] Train: 7.1833, Val: 6.9472
2025-06-10 02:57:44,276 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 950
2025-06-10 02:57:47,216 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_best.pt at step 950
2025-06-10 02:57:47,217 - src.training.utils - INFO -  New Best Model (Val: 6.9472)
2025-06-10 02:57:59,508 - src.training.utils - INFO - [Step 975/5000] Train: 6.6328, Val: 7.0736
2025-06-10 02:58:02,435 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 975
2025-06-10 02:58:02,436 - src.training.utils - INFO -  No improvement: 1/10
2025-06-10 02:58:14,985 - src.training.utils - INFO - [Step 1000/5000] Train: 6.6605, Val: 7.0550
2025-06-10 02:58:17,849 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 1000
2025-06-10 02:58:17,850 - src.training.utils - INFO -  No improvement: 2/10
2025-06-10 02:58:29,626 - src.training.utils - INFO - [Step 1025/5000] Train: 6.8329, Val: 7.0475
2025-06-10 02:58:33,266 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 1025
2025-06-10 02:58:33,267 - src.training.utils - INFO -  No improvement: 3/10
2025-06-10 02:58:46,720 - src.training.utils - INFO - [Step 1050/5000] Train: 6.8594, Val: 7.0541
2025-06-10 02:58:49,504 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 1050
2025-06-10 02:58:49,505 - src.training.utils - INFO -  No improvement: 4/10
2025-06-10 02:59:00,841 - src.training.utils - INFO - [Step 1075/5000] Train: 6.3781, Val: 7.2058
2025-06-10 02:59:03,618 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 1075
2025-06-10 02:59:03,618 - src.training.utils - INFO -  No improvement: 5/10
2025-06-10 02:59:15,879 - src.training.utils - INFO - [Step 1100/5000] Train: 6.9218, Val: 7.0765
2025-06-10 02:59:18,537 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 1100
2025-06-10 02:59:18,538 - src.training.utils - INFO -  No improvement: 6/10
2025-06-10 02:59:30,521 - src.training.utils - INFO - [Step 1125/5000] Train: 6.6450, Val: 7.1531
2025-06-10 02:59:33,747 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 1125
2025-06-10 02:59:33,747 - src.training.utils - INFO -  No improvement: 7/10
2025-06-10 02:59:46,645 - src.training.utils - INFO - [Step 1150/5000] Train: 6.7624, Val: 7.0641
2025-06-10 02:59:49,244 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 1150
2025-06-10 02:59:49,245 - src.training.utils - INFO -  No improvement: 8/10
2025-06-10 03:00:00,765 - src.training.utils - INFO - [Step 1175/5000] Train: 7.2015, Val: 7.2168
2025-06-10 03:00:03,286 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 1175
2025-06-10 03:00:03,286 - src.training.utils - INFO -  No improvement: 9/10
2025-06-10 03:00:15,784 - src.training.utils - INFO - [Step 1200/5000] Train: 6.6224, Val: 6.9603
2025-06-10 03:00:18,566 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 1200
2025-06-10 03:00:18,567 - src.training.utils - INFO -  No improvement: 10/10
2025-06-10 03:00:18,568 - src.training.utils - WARNING - >>> Early stopping triggered.
2025-06-10 03:00:18,568 - src.training.utils - INFO - Training completed at step 1200. Saving final checkpoint.
2025-06-10 03:00:22,002 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt at step 1200
2025-06-10 03:00:28,167 - src.training.utils - INFO - Preserved best checkpoint at model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_best.pt.
2025-06-10 03:00:29,938 - src.training.utils - INFO - Loss curve saved to train_eval_plots/loss_run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04.png and logged.
2025-06-10 03:00:29,982 - src.training.manager - INFO - Saved completion status to model_checkpoints/completion_tracking/tune_bs8_cw32_lr3e-04_completed.json
2025-06-10 03:00:29,982 - src.training.manager - INFO - Running post-training evaluations...
2025-06-10 03:00:30,166 - src.training.manager - INFO - Loaded best model from model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_best.pt for final eval.
2025-06-10 03:00:32,253 - src.training.manager - INFO - Average Test Set Loss: 7.1299
2025-06-10 03:00:32,290 - src.training.manager - INFO - Logging model artifact from model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_best.pt
2025-06-10 03:00:33,903 - src.training.manager - INFO - Logged artifact: Transformer_e2e_model-tune_bs8_cw32_lr3e-04
2025-06-10 03:00:33,903 - src.training.manager - INFO - Waiting for artifact upload to complete (timeout: 300s)...
2025-06-10 03:00:55,830 - src.training.manager - INFO - Artifact upload finished.
2025-06-10 03:00:55,832 - src.training.manager - INFO - Cleaning up local checkpoint files...
2025-06-10 03:00:56,330 - src.training.manager - INFO - Removed checkpoint: model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_latest.pt
2025-06-10 03:00:56,640 - src.training.manager - INFO - Removed checkpoint: model_checkpoints/run_tune_bs8_cw32_lr3e-04_bs8_cw32_lr3e-04_best.pt
2025-06-10 03:00:56,645 - src.training.manager - INFO - Training did not complete successfully - preserving checkpoints for resumption.
2025-06-10 03:00:59,615 - src.training.manager - INFO - No previous data for tune_bs8_cw32_lr1e-04. Starting fresh training.
2025-06-10 03:00:59,615 - src.training.manager - INFO - Starting Tuning Run: transformer_e2e_sweep__tune_bs8_cw32_lr1e-04 (new)
2025-06-10 03:00:59,615 - src.training.manager - INFO - Starting training run: tune_bs8_cw32_lr1e-04
2025-06-10 03:01:01,025 - src.training.manager - INFO - Run created at: 2025-06-10 03:00:59
2025-06-10 03:01:01,026 - src.training.manager - INFO - Starting fresh - Python 3.11.8
2025-06-10 03:01:01,098 - src.data.processing - INFO - Tokenizing the entire dataset..
2025-06-10 03:01:14,688 - src.data.processing - INFO - Tokenization complete. Total tokens: 2197766
2025-06-10 03:01:14,905 - src.data.processing - INFO - Train tokens: 1780191, Val tokens: 197798, Test tokens: 219777
2025-06-10 03:01:14,961 - src.models.transformer - INFO - Linearly scaling dropout from 0.100 to 0.200 over 3 layers. Result: [0.1, 0.15, 0.2]
2025-06-10 03:01:15,041 - src.training.utils - INFO - No checkpoint found. Starting fresh.
2025-06-10 03:01:15,045 - src.training.utils - INFO - Starting/Resuming training on cpu
2025-06-10 03:01:25,785 - src.training.utils - INFO - [Step 25/5000] Train: 10.7225, Val: 10.7135
2025-06-10 03:01:28,457 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 25
2025-06-10 03:01:31,870 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_best.pt at step 25
2025-06-10 03:01:31,880 - src.training.utils - INFO -  New Best Model (Val: 10.7135)
2025-06-10 03:01:48,399 - src.training.utils - INFO - [Step 50/5000] Train: 10.4102, Val: 10.3261
2025-06-10 03:01:52,176 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 50
2025-06-10 03:01:56,092 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_best.pt at step 50
2025-06-10 03:01:56,092 - src.training.utils - INFO -  New Best Model (Val: 10.3261)
2025-06-10 03:02:11,222 - src.training.utils - INFO - [Step 75/5000] Train: 9.9154, Val: 9.9005
2025-06-10 03:02:14,057 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 75
2025-06-10 03:02:17,381 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_best.pt at step 75
2025-06-10 03:02:17,383 - src.training.utils - INFO -  New Best Model (Val: 9.9005)
2025-06-10 03:02:32,691 - src.training.utils - INFO - [Step 100/5000] Train: 9.5132, Val: 9.4553
2025-06-10 03:02:35,955 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 100
2025-06-10 03:02:39,822 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_best.pt at step 100
2025-06-10 03:02:39,824 - src.training.utils - INFO -  New Best Model (Val: 9.4553)
2025-06-10 03:02:52,205 - src.training.utils - INFO - [Step 125/5000] Train: 9.1256, Val: 9.1451
2025-06-10 03:02:54,800 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 125
2025-06-10 03:02:57,520 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_best.pt at step 125
2025-06-10 03:02:57,520 - src.training.utils - INFO -  New Best Model (Val: 9.1451)
2025-06-10 03:03:11,838 - src.training.utils - INFO - [Step 150/5000] Train: 8.7415, Val: 8.8013
2025-06-10 03:03:14,571 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 150
2025-06-10 03:03:17,956 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_best.pt at step 150
2025-06-10 03:03:17,957 - src.training.utils - INFO -  New Best Model (Val: 8.8013)
2025-06-10 03:03:30,639 - src.training.utils - INFO - [Step 175/5000] Train: 8.2552, Val: 8.5839
2025-06-10 03:03:33,298 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 175
2025-06-10 03:03:37,144 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_best.pt at step 175
2025-06-10 03:03:37,150 - src.training.utils - INFO -  New Best Model (Val: 8.5839)
2025-06-10 03:03:51,038 - src.training.utils - INFO - [Step 200/5000] Train: 8.5988, Val: 8.2957
2025-06-10 03:03:53,517 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 200
2025-06-10 03:03:56,299 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_best.pt at step 200
2025-06-10 03:03:56,299 - src.training.utils - INFO -  New Best Model (Val: 8.2957)
2025-06-10 03:04:09,206 - src.training.utils - INFO - [Step 225/5000] Train: 8.2493, Val: 8.2432
2025-06-10 03:04:11,756 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 225
2025-06-10 03:04:14,767 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_best.pt at step 225
2025-06-10 03:04:14,767 - src.training.utils - INFO -  New Best Model (Val: 8.2432)
2025-06-10 03:04:28,632 - src.training.utils - INFO - [Step 250/5000] Train: 8.2501, Val: 8.0130
2025-06-10 03:04:31,986 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 250
2025-06-10 03:04:35,195 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_best.pt at step 250
2025-06-10 03:04:35,196 - src.training.utils - INFO -  New Best Model (Val: 8.0130)
2025-06-10 03:04:51,321 - src.training.utils - INFO - [Step 275/5000] Train: 7.7592, Val: 8.0778
2025-06-10 03:04:54,030 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 275
2025-06-10 03:04:54,030 - src.training.utils - INFO -  No improvement: 1/10
2025-06-10 03:05:03,876 - src.training.utils - INFO - [Step 300/5000] Train: 7.9411, Val: 7.8968
2025-06-10 03:05:06,216 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 300
2025-06-10 03:05:08,820 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_best.pt at step 300
2025-06-10 03:05:08,821 - src.training.utils - INFO -  New Best Model (Val: 7.8968)
2025-06-10 03:05:12,158 - __main__ - INFO - Training process finished.
2025-06-10 03:05:28,632 - __main__ - INFO - Starting training process with mode: sweep
2025-06-10 03:05:28,632 - src.data.processing - INFO - Loading wikitext dataset.
2025-06-10 03:05:39,195 - src.data.processing - INFO - Successfully loaded dataset.
2025-06-10 03:05:39,432 - src.data.processing - INFO - Truncated wikitext to 10000000 characters for CPU training.
2025-06-10 03:05:39,432 - src.data.processing - INFO - Loading tokenizer 'gpt2'...
2025-06-10 03:05:40,535 - src.training.manager - INFO - --- Starting Hyperparameter Search ---
2025-06-10 03:05:40,535 - src.training.manager - INFO - Hyperparameter sweep started at: 20250610_0305
2025-06-10 03:05:40,536 - src.training.manager - INFO - Found completion status for run tune_bs8_cw32_lr3e-04: early_stopping at step 1200
2025-06-10 03:05:40,537 - src.training.manager - INFO - Run tune_bs8_cw32_lr3e-04 was already completed. Creating new run with suffix.
2025-06-10 03:05:40,538 - src.training.manager - INFO - Using new run ID: tune_bs8_cw32_lr3e-04_2
2025-06-10 03:05:40,538 - src.training.manager - INFO - Starting Tuning Run: transformer_e2e_sweep__tune_bs8_cw32_lr3e-04_2 (new)
2025-06-10 03:05:40,538 - src.training.manager - INFO - Starting training run: tune_bs8_cw32_lr3e-04_2
2025-06-10 03:05:42,843 - src.training.manager - INFO - Run created at: 2025-06-10 03:05:40
2025-06-10 03:05:42,843 - src.training.manager - INFO - Starting fresh - Python 3.11.8
2025-06-10 03:05:42,864 - src.data.processing - INFO - Tokenizing the entire dataset..
2025-06-10 03:05:58,786 - src.data.processing - INFO - Tokenization complete. Total tokens: 2197766
2025-06-10 03:05:59,135 - src.data.processing - INFO - Train tokens: 1780191, Val tokens: 197798, Test tokens: 219777
2025-06-10 03:05:59,192 - src.models.transformer - INFO - Linearly scaling dropout from 0.100 to 0.200 over 3 layers. Result: [0.1, 0.15, 0.2]
2025-06-10 03:05:59,283 - src.training.utils - INFO - No checkpoint found. Starting fresh.
2025-06-10 03:06:01,048 - src.training.utils - INFO - Starting/Resuming training on cpu
2025-06-10 03:06:13,422 - src.training.utils - INFO - [Step 25/5000] Train: 10.1196, Val: 10.1028
2025-06-10 03:06:16,016 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 25
2025-06-10 03:06:18,992 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_best.pt at step 25
2025-06-10 03:06:18,993 - src.training.utils - INFO -  New Best Model (Val: 10.1028)
2025-06-10 03:06:31,804 - src.training.utils - INFO - [Step 50/5000] Train: 9.0460, Val: 9.0521
2025-06-10 03:06:38,564 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 50
2025-06-10 03:06:41,704 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_best.pt at step 50
2025-06-10 03:06:41,704 - src.training.utils - INFO -  New Best Model (Val: 9.0521)
2025-06-10 03:06:51,617 - src.training.utils - INFO - [Step 75/5000] Train: 8.0887, Val: 8.2741
2025-06-10 03:06:54,234 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 75
2025-06-10 03:06:56,807 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_best.pt at step 75
2025-06-10 03:06:56,808 - src.training.utils - INFO -  New Best Model (Val: 8.2741)
2025-06-10 03:07:06,345 - src.training.utils - INFO - [Step 100/5000] Train: 8.0169, Val: 8.0321
2025-06-10 03:07:09,203 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 100
2025-06-10 03:07:11,727 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_best.pt at step 100
2025-06-10 03:07:11,727 - src.training.utils - INFO -  New Best Model (Val: 8.0321)
2025-06-10 03:07:25,282 - src.training.utils - INFO - [Step 125/5000] Train: 7.7412, Val: 7.8563
2025-06-10 03:07:27,998 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 125
2025-06-10 03:07:31,227 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_best.pt at step 125
2025-06-10 03:07:31,227 - src.training.utils - INFO -  New Best Model (Val: 7.8563)
2025-06-10 03:07:44,297 - src.training.utils - INFO - [Step 150/5000] Train: 7.8387, Val: 7.8133
2025-06-10 03:07:46,973 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 150
2025-06-10 03:07:50,102 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_best.pt at step 150
2025-06-10 03:07:50,102 - src.training.utils - INFO -  New Best Model (Val: 7.8133)
2025-06-10 03:08:01,763 - src.training.utils - INFO - [Step 175/5000] Train: 7.5122, Val: 7.8880
2025-06-10 03:08:04,148 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 175
2025-06-10 03:08:04,149 - src.training.utils - INFO -  No improvement: 1/10
2025-06-10 03:08:16,491 - src.training.utils - INFO - [Step 200/5000] Train: 7.7447, Val: 7.7840
2025-06-10 03:08:19,221 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 200
2025-06-10 03:08:22,445 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_best.pt at step 200
2025-06-10 03:08:22,445 - src.training.utils - INFO -  New Best Model (Val: 7.7840)
2025-06-10 03:08:33,911 - src.training.utils - INFO - [Step 225/5000] Train: 7.4502, Val: 7.7296
2025-06-10 03:08:36,600 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 225
2025-06-10 03:08:40,712 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_best.pt at step 225
2025-06-10 03:08:40,712 - src.training.utils - INFO -  New Best Model (Val: 7.7296)
2025-06-10 03:08:52,192 - src.training.utils - INFO - [Step 250/5000] Train: 7.8708, Val: 7.6182
2025-06-10 03:08:54,764 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 250
2025-06-10 03:08:57,689 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_best.pt at step 250
2025-06-10 03:08:57,689 - src.training.utils - INFO -  New Best Model (Val: 7.6182)
2025-06-10 03:09:10,934 - src.training.utils - INFO - [Step 275/5000] Train: 7.3591, Val: 7.5940
2025-06-10 03:09:13,365 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 275
2025-06-10 03:09:16,592 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_best.pt at step 275
2025-06-10 03:09:16,593 - src.training.utils - INFO -  New Best Model (Val: 7.5940)
2025-06-10 03:09:28,299 - src.training.utils - INFO - [Step 300/5000] Train: 7.1280, Val: 7.5872
2025-06-10 03:09:31,062 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 300
2025-06-10 03:09:34,107 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_best.pt at step 300
2025-06-10 03:09:34,108 - src.training.utils - INFO -  New Best Model (Val: 7.5872)
2025-06-10 03:09:46,590 - src.training.utils - INFO - [Step 325/5000] Train: 7.2982, Val: 7.5505
2025-06-10 03:09:49,070 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 325
2025-06-10 03:09:51,963 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_best.pt at step 325
2025-06-10 03:09:51,963 - src.training.utils - INFO -  New Best Model (Val: 7.5505)
2025-06-10 03:10:03,697 - src.training.utils - INFO - [Step 350/5000] Train: 7.6506, Val: 7.3546
2025-06-10 03:10:06,395 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 350
2025-06-10 03:10:09,397 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_best.pt at step 350
2025-06-10 03:10:09,397 - src.training.utils - INFO -  New Best Model (Val: 7.3546)
2025-06-10 03:10:21,523 - src.training.utils - INFO - [Step 375/5000] Train: 7.5544, Val: 7.4856
2025-06-10 03:10:24,348 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 375
2025-06-10 03:10:24,349 - src.training.utils - INFO -  No improvement: 1/10
2025-06-10 03:10:35,947 - src.training.utils - INFO - [Step 400/5000] Train: 7.3229, Val: 7.2959
2025-06-10 03:10:39,647 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 400
2025-06-10 03:10:42,640 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_best.pt at step 400
2025-06-10 03:10:42,640 - src.training.utils - INFO -  New Best Model (Val: 7.2959)
2025-06-10 03:10:54,797 - src.training.utils - INFO - [Step 425/5000] Train: 7.3467, Val: 7.3318
2025-06-10 03:10:58,105 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 425
2025-06-10 03:10:58,105 - src.training.utils - INFO -  No improvement: 1/10
2025-06-10 03:11:11,219 - src.training.utils - INFO - [Step 450/5000] Train: 7.1957, Val: 7.3719
2025-06-10 03:11:13,977 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 450
2025-06-10 03:11:13,977 - src.training.utils - INFO -  No improvement: 2/10
2025-06-10 03:11:25,679 - src.training.utils - INFO - [Step 475/5000] Train: 7.4759, Val: 7.4296
2025-06-10 03:11:28,466 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 475
2025-06-10 03:11:28,467 - src.training.utils - INFO -  No improvement: 3/10
2025-06-10 03:11:41,225 - src.training.utils - INFO - [Step 500/5000] Train: 7.3811, Val: 7.3821
2025-06-10 03:11:43,822 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 500
2025-06-10 03:11:43,822 - src.training.utils - INFO -  No improvement: 4/10
2025-06-10 03:11:55,520 - src.training.utils - INFO - [Step 525/5000] Train: 6.7152, Val: 7.4797
2025-06-10 03:11:58,111 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 525
2025-06-10 03:11:58,111 - src.training.utils - INFO -  No improvement: 5/10
2025-06-10 03:12:10,297 - src.training.utils - INFO - [Step 550/5000] Train: 6.9401, Val: 7.3292
2025-06-10 03:12:13,011 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 550
2025-06-10 03:12:13,012 - src.training.utils - INFO -  No improvement: 6/10
2025-06-10 03:12:25,201 - src.training.utils - INFO - [Step 575/5000] Train: 6.8357, Val: 7.3679
2025-06-10 03:12:27,893 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 575
2025-06-10 03:12:27,893 - src.training.utils - INFO -  No improvement: 7/10
2025-06-10 03:12:40,217 - src.training.utils - INFO - [Step 600/5000] Train: 7.3036, Val: 7.1743
2025-06-10 03:12:43,047 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 600
2025-06-10 03:12:45,871 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_best.pt at step 600
2025-06-10 03:12:45,872 - src.training.utils - INFO -  New Best Model (Val: 7.1743)
2025-06-10 03:12:58,300 - src.training.utils - INFO - [Step 625/5000] Train: 7.3022, Val: 7.3384
2025-06-10 03:13:00,926 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 625
2025-06-10 03:13:00,926 - src.training.utils - INFO -  No improvement: 1/10
2025-06-10 03:13:13,229 - src.training.utils - INFO - [Step 650/5000] Train: 6.7890, Val: 7.2843
2025-06-10 03:13:16,531 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 650
2025-06-10 03:13:16,532 - src.training.utils - INFO -  No improvement: 2/10
2025-06-10 03:13:28,654 - src.training.utils - INFO - [Step 675/5000] Train: 7.5166, Val: 7.2243
2025-06-10 03:13:31,593 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 675
2025-06-10 03:13:31,594 - src.training.utils - INFO -  No improvement: 3/10
2025-06-10 03:13:44,392 - src.training.utils - INFO - [Step 700/5000] Train: 6.5069, Val: 7.2322
2025-06-10 03:13:47,349 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 700
2025-06-10 03:13:47,349 - src.training.utils - INFO -  No improvement: 4/10
2025-06-10 03:13:59,323 - src.training.utils - INFO - [Step 725/5000] Train: 7.2643, Val: 7.0561
2025-06-10 03:14:01,957 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 725
2025-06-10 03:14:05,099 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_best.pt at step 725
2025-06-10 03:14:05,099 - src.training.utils - INFO -  New Best Model (Val: 7.0561)
2025-06-10 03:14:17,696 - src.training.utils - INFO - [Step 750/5000] Train: 7.1382, Val: 7.2234
2025-06-10 03:14:20,516 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 750
2025-06-10 03:14:20,516 - src.training.utils - INFO -  No improvement: 1/10
2025-06-10 03:14:32,367 - src.training.utils - INFO - [Step 775/5000] Train: 7.1115, Val: 7.1424
2025-06-10 03:14:35,107 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 775
2025-06-10 03:14:35,108 - src.training.utils - INFO -  No improvement: 2/10
2025-06-10 03:14:47,933 - src.training.utils - INFO - [Step 800/5000] Train: 7.1408, Val: 7.2675
2025-06-10 03:14:50,989 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 800
2025-06-10 03:14:50,989 - src.training.utils - INFO -  No improvement: 3/10
2025-06-10 03:15:02,829 - src.training.utils - INFO - [Step 825/5000] Train: 6.9656, Val: 7.1973
2025-06-10 03:15:05,494 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 825
2025-06-10 03:15:05,494 - src.training.utils - INFO -  No improvement: 4/10
2025-06-10 03:15:21,038 - src.training.utils - INFO - [Step 850/5000] Train: 6.8659, Val: 7.2243
2025-06-10 03:15:24,701 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 850
2025-06-10 03:15:24,702 - src.training.utils - INFO -  No improvement: 5/10
2025-06-10 03:15:38,443 - src.training.utils - INFO - [Step 875/5000] Train: 7.2986, Val: 7.1536
2025-06-10 03:15:43,101 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 875
2025-06-10 03:15:43,105 - src.training.utils - INFO -  No improvement: 6/10
2025-06-10 03:15:55,678 - src.training.utils - INFO - [Step 900/5000] Train: 7.1859, Val: 7.1388
2025-06-10 03:15:58,472 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 900
2025-06-10 03:15:58,473 - src.training.utils - INFO -  No improvement: 7/10
2025-06-10 03:16:11,008 - src.training.utils - INFO - [Step 925/5000] Train: 7.0429, Val: 7.3501
2025-06-10 03:16:13,647 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 925
2025-06-10 03:16:13,648 - src.training.utils - INFO -  No improvement: 8/10
2025-06-10 03:16:31,454 - src.training.utils - INFO - [Step 950/5000] Train: 7.0526, Val: 7.0032
2025-06-10 03:16:34,224 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 950
2025-06-10 03:16:37,981 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_best.pt at step 950
2025-06-10 03:16:37,983 - src.training.utils - INFO -  New Best Model (Val: 7.0032)
2025-06-10 03:16:50,270 - src.training.utils - INFO - [Step 975/5000] Train: 7.1117, Val: 7.2598
2025-06-10 03:16:53,163 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 975
2025-06-10 03:16:53,164 - src.training.utils - INFO -  No improvement: 1/10
2025-06-10 03:17:05,288 - src.training.utils - INFO - [Step 1000/5000] Train: 7.1524, Val: 6.9411
2025-06-10 03:17:08,512 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 1000
2025-06-10 03:17:11,679 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_best.pt at step 1000
2025-06-10 03:17:11,681 - src.training.utils - INFO -  New Best Model (Val: 6.9411)
2025-06-10 03:17:24,119 - src.training.utils - INFO - [Step 1025/5000] Train: 6.3558, Val: 7.0964
2025-06-10 03:17:26,659 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 1025
2025-06-10 03:17:26,659 - src.training.utils - INFO -  No improvement: 1/10
2025-06-10 03:17:39,508 - src.training.utils - INFO - [Step 1050/5000] Train: 7.2160, Val: 7.2140
2025-06-10 03:17:42,321 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 1050
2025-06-10 03:17:42,321 - src.training.utils - INFO -  No improvement: 2/10
2025-06-10 03:17:56,160 - src.training.utils - INFO - [Step 1075/5000] Train: 6.9752, Val: 7.0322
2025-06-10 03:17:58,739 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 1075
2025-06-10 03:17:58,740 - src.training.utils - INFO -  No improvement: 3/10
2025-06-10 03:18:11,371 - src.training.utils - INFO - [Step 1100/5000] Train: 7.1257, Val: 7.0919
2025-06-10 03:18:13,968 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 1100
2025-06-10 03:18:13,968 - src.training.utils - INFO -  No improvement: 4/10
2025-06-10 03:18:27,084 - src.training.utils - INFO - [Step 1125/5000] Train: 6.9081, Val: 7.2509
2025-06-10 03:18:29,638 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 1125
2025-06-10 03:18:29,638 - src.training.utils - INFO -  No improvement: 5/10
2025-06-10 03:18:43,278 - src.training.utils - INFO - [Step 1150/5000] Train: 7.1261, Val: 7.0958
2025-06-10 03:18:46,356 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 1150
2025-06-10 03:18:46,356 - src.training.utils - INFO -  No improvement: 6/10
2025-06-10 03:18:59,228 - src.training.utils - INFO - [Step 1175/5000] Train: 7.2655, Val: 7.1541
2025-06-10 03:19:01,937 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 1175
2025-06-10 03:19:01,938 - src.training.utils - INFO -  No improvement: 7/10
2025-06-10 03:19:14,351 - src.training.utils - INFO - [Step 1200/5000] Train: 7.2565, Val: 6.9066
2025-06-10 03:19:16,990 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 1200
2025-06-10 03:19:20,127 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_best.pt at step 1200
2025-06-10 03:19:20,128 - src.training.utils - INFO -  New Best Model (Val: 6.9066)
2025-06-10 03:19:32,305 - src.training.utils - INFO - [Step 1225/5000] Train: 7.2802, Val: 7.2061
2025-06-10 03:19:35,476 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 1225
2025-06-10 03:19:35,479 - src.training.utils - INFO -  No improvement: 1/10
2025-06-10 03:19:47,677 - src.training.utils - INFO - [Step 1250/5000] Train: 7.2723, Val: 7.1631
2025-06-10 03:19:50,591 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 1250
2025-06-10 03:19:50,592 - src.training.utils - INFO -  No improvement: 2/10
2025-06-10 03:20:04,336 - src.training.utils - INFO - [Step 1275/5000] Train: 7.2285, Val: 7.2455
2025-06-10 03:20:07,164 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 1275
2025-06-10 03:20:07,165 - src.training.utils - INFO -  No improvement: 3/10
2025-06-10 03:20:20,812 - src.training.utils - INFO - [Step 1300/5000] Train: 7.1183, Val: 7.1607
2025-06-10 03:20:23,871 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 1300
2025-06-10 03:20:23,871 - src.training.utils - INFO -  No improvement: 4/10
2025-06-10 03:20:36,445 - src.training.utils - INFO - [Step 1325/5000] Train: 6.7755, Val: 7.1799
2025-06-10 03:20:40,918 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 1325
2025-06-10 03:20:40,918 - src.training.utils - INFO -  No improvement: 5/10
2025-06-10 03:20:53,727 - src.training.utils - INFO - [Step 1350/5000] Train: 6.8518, Val: 7.1321
2025-06-10 03:20:56,864 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 1350
2025-06-10 03:20:56,865 - src.training.utils - INFO -  No improvement: 6/10
2025-06-10 03:21:13,604 - src.training.utils - INFO - [Step 1375/5000] Train: 7.1080, Val: 7.1384
2025-06-10 03:21:16,427 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 1375
2025-06-10 03:21:16,427 - src.training.utils - INFO -  No improvement: 7/10
2025-06-10 03:21:28,475 - src.training.utils - INFO - [Step 1400/5000] Train: 6.8363, Val: 7.1919
2025-06-10 03:21:31,135 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 1400
2025-06-10 03:21:31,136 - src.training.utils - INFO -  No improvement: 8/10
2025-06-10 03:21:44,231 - src.training.utils - INFO - [Step 1425/5000] Train: 6.9429, Val: 7.0970
2025-06-10 03:21:47,583 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 1425
2025-06-10 03:21:47,584 - src.training.utils - INFO -  No improvement: 9/10
2025-06-10 03:22:03,303 - src.training.utils - INFO - [Step 1450/5000] Train: 6.8991, Val: 7.1830
2025-06-10 03:22:06,391 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 1450
2025-06-10 03:22:06,392 - src.training.utils - INFO -  No improvement: 10/10
2025-06-10 03:22:06,393 - src.training.utils - WARNING - >>> Early stopping triggered.
2025-06-10 03:22:06,394 - src.training.utils - INFO - Training completed at step 1450. Saving final checkpoint.
2025-06-10 03:22:09,215 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt at step 1450
2025-06-10 03:22:13,256 - src.training.utils - INFO - Preserved best checkpoint at model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_best.pt.
2025-06-10 03:22:15,046 - src.training.utils - INFO - Loss curve saved to train_eval_plots/loss_run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04.png and logged.
2025-06-10 03:22:15,105 - src.training.manager - INFO - Saved completion status to model_checkpoints/completion_tracking/tune_bs8_cw32_lr3e-04_2_completed.json
2025-06-10 03:22:15,106 - src.training.manager - INFO - Running post-training evaluations...
2025-06-10 03:22:15,616 - src.training.manager - INFO - Loaded best model from model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_best.pt for final eval.
2025-06-10 03:22:17,480 - src.training.manager - INFO - Average Test Set Loss: 7.0849
2025-06-10 03:22:17,519 - src.training.manager - INFO - Logging model artifact from model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_best.pt
2025-06-10 03:22:19,449 - src.training.manager - INFO - Logged artifact: Transformer_e2e_model-tune_bs8_cw32_lr3e-04_2
2025-06-10 03:22:19,450 - src.training.manager - INFO - Waiting for artifact upload to complete (timeout: 300s)...
2025-06-10 03:22:40,399 - src.training.manager - INFO - Artifact upload finished.
2025-06-10 03:22:40,401 - src.training.manager - INFO - Cleaning up local checkpoint files...
2025-06-10 03:22:40,750 - src.training.manager - INFO - Removed checkpoint: model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_latest.pt
2025-06-10 03:22:41,035 - src.training.manager - INFO - Removed checkpoint: model_checkpoints/run_tune_bs8_cw32_lr3e-04_2_bs8_cw32_lr3e-04_best.pt
2025-06-10 03:22:41,035 - src.training.manager - INFO - Training did not complete successfully - preserving checkpoints for resumption.
2025-06-10 03:22:44,002 - src.training.manager - INFO - Found checkpoints for incomplete run tune_bs8_cw32_lr1e-04. Resuming interrupted training.
2025-06-10 03:22:44,003 - src.training.manager - INFO - Starting Tuning Run: transformer_e2e_sweep__tune_bs8_cw32_lr1e-04 (resumed)
2025-06-10 03:22:44,003 - src.training.manager - INFO - Resuming training run: tune_bs8_cw32_lr1e-04
2025-06-10 03:22:45,768 - src.training.manager - INFO - Run created at: 2025-06-10 03:22:44
2025-06-10 03:22:45,769 - src.training.manager - INFO - Resuming - Python 3.11.8
2025-06-10 03:22:45,858 - src.data.processing - INFO - Tokenizing the entire dataset..
2025-06-10 03:23:06,255 - src.data.processing - INFO - Tokenization complete. Total tokens: 2197766
2025-06-10 03:23:06,649 - src.data.processing - INFO - Train tokens: 1780191, Val tokens: 197798, Test tokens: 219777
2025-06-10 03:23:06,707 - src.models.transformer - INFO - Linearly scaling dropout from 0.100 to 0.200 over 3 layers. Result: [0.1, 0.15, 0.2]
2025-06-10 03:23:06,796 - src.training.utils - INFO - Found checkpoint: model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt. Attempting to resume.
2025-06-10 03:23:07,395 - src.training.utils - INFO - Resuming from step 301 with best_val_loss 8.0130
2025-06-10 03:23:07,457 - src.training.utils - INFO - Starting/Resuming training on cpu
2025-06-10 03:23:07,458 - src.training.utils - INFO - Loaded optimizer state from checkpoint.
2025-06-10 03:23:20,151 - src.training.utils - INFO - [Step 325/5000] Train: 7.7678, Val: 7.8643
2025-06-10 03:23:22,905 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 325
2025-06-10 03:23:26,633 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_best.pt at step 325
2025-06-10 03:23:26,634 - src.training.utils - INFO -  New Best Model (Val: 7.8643)
2025-06-10 03:23:40,298 - src.training.utils - INFO - [Step 350/5000] Train: 7.2880, Val: 7.8109
2025-06-10 03:23:43,024 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 350
2025-06-10 03:23:46,180 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_best.pt at step 350
2025-06-10 03:23:46,180 - src.training.utils - INFO -  New Best Model (Val: 7.8109)
2025-06-10 03:23:59,129 - src.training.utils - INFO - [Step 375/5000] Train: 7.7422, Val: 7.7241
2025-06-10 03:24:01,851 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 375
2025-06-10 03:24:06,090 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_best.pt at step 375
2025-06-10 03:24:06,091 - src.training.utils - INFO -  New Best Model (Val: 7.7241)
2025-06-10 03:24:19,285 - src.training.utils - INFO - [Step 400/5000] Train: 7.6460, Val: 7.6479
2025-06-10 03:24:21,820 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 400
2025-06-10 03:24:24,946 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_best.pt at step 400
2025-06-10 03:24:24,946 - src.training.utils - INFO -  New Best Model (Val: 7.6479)
2025-06-10 03:24:41,791 - src.training.utils - INFO - [Step 425/5000] Train: 7.6155, Val: 7.6697
2025-06-10 03:24:44,634 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 425
2025-06-10 03:24:44,635 - src.training.utils - INFO -  No improvement: 1/10
2025-06-10 03:24:58,442 - src.training.utils - INFO - [Step 450/5000] Train: 7.8764, Val: 7.6488
2025-06-10 03:25:02,304 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 450
2025-06-10 03:25:02,304 - src.training.utils - INFO -  No improvement: 2/10
2025-06-10 03:25:19,610 - src.training.utils - INFO - [Step 475/5000] Train: 7.6569, Val: 7.7266
2025-06-10 03:25:23,203 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 475
2025-06-10 03:25:23,204 - src.training.utils - INFO -  No improvement: 3/10
2025-06-10 03:25:40,628 - src.training.utils - INFO - [Step 500/5000] Train: 7.3421, Val: 7.6351
2025-06-10 03:25:43,506 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 500
2025-06-10 03:25:46,394 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_best.pt at step 500
2025-06-10 03:25:46,395 - src.training.utils - INFO -  New Best Model (Val: 7.6351)
2025-06-10 03:25:59,873 - src.training.utils - INFO - [Step 525/5000] Train: 7.5869, Val: 7.6007
2025-06-10 03:26:02,564 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 525
2025-06-10 03:26:05,662 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_best.pt at step 525
2025-06-10 03:26:05,662 - src.training.utils - INFO -  New Best Model (Val: 7.6007)
2025-06-10 03:26:19,634 - src.training.utils - INFO - [Step 550/5000] Train: 7.8036, Val: 7.5825
2025-06-10 03:26:22,472 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 550
2025-06-10 03:26:25,260 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_best.pt at step 550
2025-06-10 03:26:25,261 - src.training.utils - INFO -  New Best Model (Val: 7.5825)
2025-06-10 03:26:38,494 - src.training.utils - INFO - [Step 575/5000] Train: 7.7167, Val: 7.7009
2025-06-10 03:26:41,029 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 575
2025-06-10 03:26:41,030 - src.training.utils - INFO -  No improvement: 1/10
2025-06-10 03:26:53,838 - src.training.utils - INFO - [Step 600/5000] Train: 7.7131, Val: 7.6244
2025-06-10 03:26:56,345 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 600
2025-06-10 03:26:56,346 - src.training.utils - INFO -  No improvement: 2/10
2025-06-10 03:27:10,303 - src.training.utils - INFO - [Step 625/5000] Train: 7.6446, Val: 7.4303
2025-06-10 03:27:12,985 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 625
2025-06-10 03:27:15,756 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_best.pt at step 625
2025-06-10 03:27:15,756 - src.training.utils - INFO -  New Best Model (Val: 7.4303)
2025-06-10 03:27:28,439 - src.training.utils - INFO - [Step 650/5000] Train: 7.6169, Val: 7.5600
2025-06-10 03:27:30,926 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 650
2025-06-10 03:27:30,926 - src.training.utils - INFO -  No improvement: 1/10
2025-06-10 03:27:43,931 - src.training.utils - INFO - [Step 675/5000] Train: 7.7301, Val: 7.4523
2025-06-10 03:27:46,677 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 675
2025-06-10 03:27:46,678 - src.training.utils - INFO -  No improvement: 2/10
2025-06-10 03:27:59,284 - src.training.utils - INFO - [Step 700/5000] Train: 7.7539, Val: 7.5594
2025-06-10 03:28:01,958 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 700
2025-06-10 03:28:01,958 - src.training.utils - INFO -  No improvement: 3/10
2025-06-10 03:28:15,717 - src.training.utils - INFO - [Step 725/5000] Train: 7.5850, Val: 7.5905
2025-06-10 03:28:18,209 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 725
2025-06-10 03:28:18,209 - src.training.utils - INFO -  No improvement: 4/10
2025-06-10 03:28:30,754 - src.training.utils - INFO - [Step 750/5000] Train: 7.7221, Val: 7.6641
2025-06-10 03:28:33,517 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 750
2025-06-10 03:28:33,517 - src.training.utils - INFO -  No improvement: 5/10
2025-06-10 03:28:46,633 - src.training.utils - INFO - [Step 775/5000] Train: 7.7247, Val: 7.5828
2025-06-10 03:28:49,563 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 775
2025-06-10 03:28:49,564 - src.training.utils - INFO -  No improvement: 6/10
2025-06-10 03:29:02,841 - src.training.utils - INFO - [Step 800/5000] Train: 7.5868, Val: 7.4315
2025-06-10 03:29:05,709 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 800
2025-06-10 03:29:05,710 - src.training.utils - INFO -  No improvement: 7/10
2025-06-10 03:29:19,362 - src.training.utils - INFO - [Step 825/5000] Train: 7.1505, Val: 7.5355
2025-06-10 03:29:21,881 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 825
2025-06-10 03:29:21,881 - src.training.utils - INFO -  No improvement: 8/10
2025-06-10 03:29:35,029 - src.training.utils - INFO - [Step 850/5000] Train: 7.4886, Val: 7.4968
2025-06-10 03:29:38,560 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 850
2025-06-10 03:29:38,561 - src.training.utils - INFO -  No improvement: 9/10
2025-06-10 03:29:51,218 - src.training.utils - INFO - [Step 875/5000] Train: 7.2628, Val: 7.5310
2025-06-10 03:29:54,368 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 875
2025-06-10 03:29:54,368 - src.training.utils - INFO -  No improvement: 10/10
2025-06-10 03:29:54,370 - src.training.utils - WARNING - >>> Early stopping triggered.
2025-06-10 03:29:54,371 - src.training.utils - INFO - Training completed at step 875. Saving final checkpoint.
2025-06-10 03:29:56,921 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt at step 875
2025-06-10 03:30:00,384 - src.training.utils - INFO - Preserved best checkpoint at model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_best.pt.
2025-06-10 03:30:01,550 - src.training.utils - INFO - Loss curve saved to train_eval_plots/loss_run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04.png and logged.
2025-06-10 03:30:01,590 - src.training.manager - INFO - Saved completion status to model_checkpoints/completion_tracking/tune_bs8_cw32_lr1e-04_completed.json
2025-06-10 03:30:01,591 - src.training.manager - INFO - Running post-training evaluations...
2025-06-10 03:30:01,710 - src.training.manager - INFO - Loaded best model from model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_best.pt for final eval.
2025-06-10 03:30:03,684 - src.training.manager - INFO - Average Test Set Loss: 7.6069
2025-06-10 03:30:03,724 - src.training.manager - INFO - Logging model artifact from model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_best.pt
2025-06-10 03:30:05,571 - src.training.manager - INFO - Logged artifact: Transformer_e2e_model-tune_bs8_cw32_lr1e-04
2025-06-10 03:30:05,571 - src.training.manager - INFO - Waiting for artifact upload to complete (timeout: 300s)...
2025-06-10 03:30:26,896 - src.training.manager - INFO - Artifact upload finished.
2025-06-10 03:30:26,898 - src.training.manager - INFO - Cleaning up local checkpoint files...
2025-06-10 03:30:27,148 - src.training.manager - INFO - Removed checkpoint: model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_latest.pt
2025-06-10 03:30:27,407 - src.training.manager - INFO - Removed checkpoint: model_checkpoints/run_tune_bs8_cw32_lr1e-04_bs8_cw32_lr1e-04_best.pt
2025-06-10 03:30:27,408 - src.training.manager - INFO - Training did not complete successfully - preserving checkpoints for resumption.
2025-06-10 03:30:30,241 - src.training.manager - INFO - No previous data for tune_bs8_cw64_lr3e-04. Starting fresh training.
2025-06-10 03:30:30,242 - src.training.manager - INFO - Starting Tuning Run: transformer_e2e_sweep__tune_bs8_cw64_lr3e-04 (new)
2025-06-10 03:30:30,242 - src.training.manager - INFO - Starting training run: tune_bs8_cw64_lr3e-04
2025-06-10 03:30:31,686 - src.training.manager - INFO - Run created at: 2025-06-10 03:30:30
2025-06-10 03:30:31,686 - src.training.manager - INFO - Starting fresh - Python 3.11.8
2025-06-10 03:30:31,754 - src.data.processing - INFO - Tokenizing the entire dataset..
2025-06-10 03:30:48,044 - src.data.processing - INFO - Tokenization complete. Total tokens: 2197766
2025-06-10 03:30:48,399 - src.data.processing - INFO - Train tokens: 1780191, Val tokens: 197798, Test tokens: 219777
2025-06-10 03:30:48,452 - src.models.transformer - INFO - Linearly scaling dropout from 0.100 to 0.200 over 3 layers. Result: [0.1, 0.15, 0.2]
2025-06-10 03:30:48,550 - src.training.utils - INFO - No checkpoint found. Starting fresh.
2025-06-10 03:30:48,554 - src.training.utils - INFO - Starting/Resuming training on cpu
2025-06-10 03:31:14,967 - src.training.utils - INFO - [Step 25/5000] Train: 9.9738, Val: 9.8418
2025-06-10 03:31:17,745 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw64_lr3e-04_bs8_cw64_lr3e-04_latest.pt at step 25
2025-06-10 03:31:21,010 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw64_lr3e-04_bs8_cw64_lr3e-04_best.pt at step 25
2025-06-10 03:31:21,010 - src.training.utils - INFO -  New Best Model (Val: 9.8418)
2025-06-10 03:31:49,188 - src.training.utils - INFO - [Step 50/5000] Train: 8.7969, Val: 8.8194
2025-06-10 03:31:51,909 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw64_lr3e-04_bs8_cw64_lr3e-04_latest.pt at step 50
2025-06-10 03:31:55,954 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw64_lr3e-04_bs8_cw64_lr3e-04_best.pt at step 50
2025-06-10 03:31:55,955 - src.training.utils - INFO -  New Best Model (Val: 8.8194)
2025-06-10 03:32:18,032 - src.training.utils - INFO - [Step 75/5000] Train: 8.0363, Val: 8.0794
2025-06-10 03:32:20,854 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw64_lr3e-04_bs8_cw64_lr3e-04_latest.pt at step 75
2025-06-10 03:32:23,686 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw64_lr3e-04_bs8_cw64_lr3e-04_best.pt at step 75
2025-06-10 03:32:23,687 - src.training.utils - INFO -  New Best Model (Val: 8.0794)
2025-06-10 03:32:44,955 - src.training.utils - INFO - [Step 100/5000] Train: 7.8422, Val: 7.7699
2025-06-10 03:32:48,076 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw64_lr3e-04_bs8_cw64_lr3e-04_latest.pt at step 100
2025-06-10 03:32:51,077 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw64_lr3e-04_bs8_cw64_lr3e-04_best.pt at step 100
2025-06-10 03:32:51,077 - src.training.utils - INFO -  New Best Model (Val: 7.7699)
2025-06-10 03:33:12,591 - src.training.utils - INFO - [Step 125/5000] Train: 7.5667, Val: 7.7620
2025-06-10 03:33:16,303 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw64_lr3e-04_bs8_cw64_lr3e-04_latest.pt at step 125
2025-06-10 03:33:19,048 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw64_lr3e-04_bs8_cw64_lr3e-04_best.pt at step 125
2025-06-10 03:33:19,048 - src.training.utils - INFO -  New Best Model (Val: 7.7620)
2025-06-10 03:33:40,670 - src.training.utils - INFO - [Step 150/5000] Train: 7.6488, Val: 7.6502
2025-06-10 03:33:43,967 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw64_lr3e-04_bs8_cw64_lr3e-04_latest.pt at step 150
2025-06-10 03:33:47,389 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw64_lr3e-04_bs8_cw64_lr3e-04_best.pt at step 150
2025-06-10 03:33:47,390 - src.training.utils - INFO -  New Best Model (Val: 7.6502)
2025-06-10 03:34:09,089 - src.training.utils - INFO - [Step 175/5000] Train: 7.5928, Val: 7.7204
2025-06-10 03:34:11,926 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw64_lr3e-04_bs8_cw64_lr3e-04_latest.pt at step 175
2025-06-10 03:34:11,927 - src.training.utils - INFO -  No improvement: 1/10
2025-06-10 03:34:34,595 - src.training.utils - INFO - [Step 200/5000] Train: 7.2647, Val: 7.6798
2025-06-10 03:34:37,261 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw64_lr3e-04_bs8_cw64_lr3e-04_latest.pt at step 200
2025-06-10 03:34:37,261 - src.training.utils - INFO -  No improvement: 2/10
2025-06-10 03:34:58,463 - src.training.utils - INFO - [Step 225/5000] Train: 7.3376, Val: 7.5521
2025-06-10 03:35:01,201 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw64_lr3e-04_bs8_cw64_lr3e-04_latest.pt at step 225
2025-06-10 03:35:04,499 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw64_lr3e-04_bs8_cw64_lr3e-04_best.pt at step 225
2025-06-10 03:35:04,500 - src.training.utils - INFO -  New Best Model (Val: 7.5521)
2025-06-10 03:35:27,314 - src.training.utils - INFO - [Step 250/5000] Train: 7.6395, Val: 7.5395
2025-06-10 03:35:30,468 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw64_lr3e-04_bs8_cw64_lr3e-04_latest.pt at step 250
2025-06-10 03:35:33,385 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw64_lr3e-04_bs8_cw64_lr3e-04_best.pt at step 250
2025-06-10 03:35:33,385 - src.training.utils - INFO -  New Best Model (Val: 7.5395)
2025-06-10 03:35:56,194 - src.training.utils - INFO - [Step 275/5000] Train: 7.1671, Val: 7.4082
2025-06-10 03:35:59,939 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw64_lr3e-04_bs8_cw64_lr3e-04_latest.pt at step 275
2025-06-10 03:36:03,005 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw64_lr3e-04_bs8_cw64_lr3e-04_best.pt at step 275
2025-06-10 03:36:03,005 - src.training.utils - INFO -  New Best Model (Val: 7.4082)
2025-06-10 03:36:25,868 - src.training.utils - INFO - [Step 300/5000] Train: 7.4606, Val: 7.4435
2025-06-10 03:36:29,027 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw64_lr3e-04_bs8_cw64_lr3e-04_latest.pt at step 300
2025-06-10 03:36:29,028 - src.training.utils - INFO -  No improvement: 1/10
2025-06-10 03:36:50,388 - src.training.utils - INFO - [Step 325/5000] Train: 7.3662, Val: 7.2688
2025-06-10 03:36:52,933 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw64_lr3e-04_bs8_cw64_lr3e-04_latest.pt at step 325
2025-06-10 03:36:59,109 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw64_lr3e-04_bs8_cw64_lr3e-04_best.pt at step 325
2025-06-10 03:36:59,116 - src.training.utils - INFO -  New Best Model (Val: 7.2688)
2025-06-10 03:37:02,141 - __main__ - INFO - Training process finished.
2025-06-10 15:48:24,082 - __main__ - INFO - Starting training process with mode: single
2025-06-10 15:48:24,086 - src.data.processing - INFO - Loading wikitext dataset.
2025-06-10 15:48:35,514 - src.data.processing - INFO - Successfully loaded dataset.
2025-06-10 15:48:35,728 - src.data.processing - INFO - Truncated wikitext to 10000000 characters for CPU training.
2025-06-10 15:48:35,728 - src.data.processing - INFO - Loading tokenizer 'gpt2'...
2025-06-10 15:48:36,925 - __main__ - CRITICAL - Unhandled error in single run: Unknown format code 'e' for object of type 'str'
Traceback (most recent call last):
  File "/Users/kritiagrawal/Desktop/job_practice/ml_engineering/transformer_e2e/scripts/train.py", line 68, in main
    run_single_training(raw_text, tokenizer, cfg)
  File "/Users/kritiagrawal/Desktop/job_practice/ml_engineering/transformer_e2e/src/training/manager.py", line 583, in run_single_training
    run_id, is_resuming = generate_smart_run_id(base_run_id, cfg)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kritiagrawal/Desktop/job_practice/ml_engineering/transformer_e2e/src/training/manager.py", line 56, in generate_smart_run_id
    elif has_checkpoints(base_run_id):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kritiagrawal/Desktop/job_practice/ml_engineering/transformer_e2e/src/training/manager.py", line 44, in has_checkpoints
    checkpoint_paths = get_checkpoint_paths(run_id, cfg)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/kritiagrawal/Desktop/job_practice/ml_engineering/transformer_e2e/src/training/utils.py", line 36, in get_checkpoint_paths
    lr = f"{cfg.LEARNING_RATE:.0e}" if hasattr(cfg, 'LEARNING_RATE') else "unknown"
         ^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Unknown format code 'e' for object of type 'str'
2025-06-10 15:48:36,928 - __main__ - INFO - Training process finished.
2025-06-10 16:01:03,966 - __main__ - INFO - Starting training process with mode: single
2025-06-10 16:01:03,966 - src.data.processing - INFO - Loading wikitext dataset.
2025-06-10 16:01:16,980 - src.data.processing - INFO - Successfully loaded dataset.
2025-06-10 16:01:17,527 - src.data.processing - INFO - Truncated wikitext to 10000000 characters for CPU training.
2025-06-10 16:01:17,527 - src.data.processing - INFO - Loading tokenizer 'gpt2'...
2025-06-10 16:01:19,801 - src.training.manager - INFO - No previous data for transformer_e2e_single_run__transformer_e2e_sweep_. Starting fresh training.
2025-06-10 16:01:19,805 - src.training.manager - INFO - Starting training run: transformer_e2e_single_run__transformer_e2e_sweep_
2025-06-10 16:01:23,005 - src.training.manager - INFO - Run created at: 2025-06-10 16:01:19
2025-06-10 16:01:23,006 - src.training.manager - INFO - Starting fresh - Python 3.11.8
2025-06-10 16:01:23,106 - src.data.processing - INFO - Tokenizing the entire dataset..
2025-06-10 16:01:57,592 - src.data.processing - INFO - Tokenization complete. Total tokens: 2197766
2025-06-10 16:01:57,840 - src.data.processing - INFO - Train tokens: 1780191, Val tokens: 197798, Test tokens: 219777
2025-06-10 16:01:57,919 - src.models.transformer - INFO - Linearly scaling dropout from 0.100 to 0.200 over 3 layers. Result: [0.1, 0.15, 0.2]
2025-06-10 16:01:58,035 - src.training.utils - INFO - No checkpoint found. Starting fresh.
2025-06-10 16:01:58,041 - src.training.manager - CRITICAL - Critical error in run transformer_e2e_single_run__transformer_e2e_sweep_: '<=' not supported between instances of 'float' and 'str'
Traceback (most recent call last):
  File "/Users/kritiagrawal/Desktop/job_practice/ml_engineering/transformer_e2e/src/training/manager.py", line 435, in run
    optimizer = optim.AdamW(
                ^^^^^^^^^^^^
  File "/Users/kritiagrawal/Desktop/job_practice/ml_engineering/transformer_e2e/.venv/lib/python3.11/site-packages/torch/optim/adamw.py", line 28, in __init__
    if not 0.0 <= lr:
           ^^^^^^^^^
TypeError: '<=' not supported between instances of 'float' and 'str'
2025-06-10 16:02:00,000 - __main__ - INFO - Training process finished.
2025-06-10 16:04:51,556 - __main__ - INFO - Starting training process with mode: single
2025-06-10 16:04:51,557 - src.data.processing - INFO - Loading wikitext dataset.
2025-06-10 16:05:03,212 - src.data.processing - INFO - Successfully loaded dataset.
2025-06-10 16:05:03,591 - src.data.processing - INFO - Truncated wikitext to 10000000 characters for CPU training.
2025-06-10 16:05:03,591 - src.data.processing - INFO - Loading tokenizer 'gpt2'...
2025-06-10 16:05:05,006 - src.training.manager - INFO - No previous data for transformer_e2e_single_run__transformer_e2e_sweep_. Starting fresh training.
2025-06-10 16:05:05,007 - src.training.manager - INFO - Starting training run: transformer_e2e_single_run__transformer_e2e_sweep_
2025-06-10 16:05:07,916 - src.training.manager - INFO - Run created at: 2025-06-10 16:05:05
2025-06-10 16:05:07,916 - src.training.manager - INFO - Starting fresh - Python 3.11.8
2025-06-10 16:05:07,942 - src.data.processing - INFO - Tokenizing the entire dataset..
2025-06-10 16:05:34,201 - src.data.processing - INFO - Tokenization complete. Total tokens: 2197766
2025-06-10 16:05:34,481 - src.data.processing - INFO - Train tokens: 1780191, Val tokens: 197798, Test tokens: 219777
2025-06-10 16:05:34,559 - src.models.transformer - INFO - Linearly scaling dropout from 0.100 to 0.200 over 3 layers. Result: [0.1, 0.15, 0.2]
2025-06-10 16:05:34,698 - src.training.utils - INFO - No checkpoint found. Starting fresh.
2025-06-10 16:05:38,135 - src.training.utils - INFO - Starting/Resuming training on cpu
2025-06-10 16:06:39,695 - src.training.utils - INFO - [Step 100/1000] Train: 7.6743, Val: 8.0091
2025-06-10 16:06:41,304 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_transformer_e2e_single_run__transformer_e2e_sweep__bs12_cw16_lr3e-04_latest.pt at step 100
2025-06-10 16:06:43,731 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_transformer_e2e_single_run__transformer_e2e_sweep__bs12_cw16_lr3e-04_best.pt at step 100
2025-06-10 16:06:43,732 - src.training.utils - INFO -  New Best Model (Val: 8.0091)
2025-06-10 16:07:51,399 - src.training.utils - INFO - [Step 200/1000] Train: 7.8059, Val: 7.8777
2025-06-10 16:07:52,969 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_transformer_e2e_single_run__transformer_e2e_sweep__bs12_cw16_lr3e-04_latest.pt at step 200
2025-06-10 16:07:55,131 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_transformer_e2e_single_run__transformer_e2e_sweep__bs12_cw16_lr3e-04_best.pt at step 200
2025-06-10 16:07:55,133 - src.training.utils - INFO -  New Best Model (Val: 7.8777)
2025-06-10 16:08:40,771 - src.training.utils - INFO - [Step 300/1000] Train: 7.6911, Val: 7.5657
2025-06-10 16:08:41,528 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_transformer_e2e_single_run__transformer_e2e_sweep__bs12_cw16_lr3e-04_latest.pt at step 300
2025-06-10 16:08:42,568 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_transformer_e2e_single_run__transformer_e2e_sweep__bs12_cw16_lr3e-04_best.pt at step 300
2025-06-10 16:08:42,569 - src.training.utils - INFO -  New Best Model (Val: 7.5657)
2025-06-10 16:10:10,721 - src.training.utils - INFO - [Step 400/1000] Train: 7.4308, Val: 7.5037
2025-06-10 16:10:12,341 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_transformer_e2e_single_run__transformer_e2e_sweep__bs12_cw16_lr3e-04_latest.pt at step 400
2025-06-10 16:10:14,718 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_transformer_e2e_single_run__transformer_e2e_sweep__bs12_cw16_lr3e-04_best.pt at step 400
2025-06-10 16:10:14,719 - src.training.utils - INFO -  New Best Model (Val: 7.5037)
2025-06-10 16:11:35,624 - src.training.utils - INFO - [Step 500/1000] Train: 7.1834, Val: 7.1771
2025-06-10 16:11:37,526 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_transformer_e2e_single_run__transformer_e2e_sweep__bs12_cw16_lr3e-04_latest.pt at step 500
2025-06-10 16:11:39,508 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_transformer_e2e_single_run__transformer_e2e_sweep__bs12_cw16_lr3e-04_best.pt at step 500
2025-06-10 16:11:39,510 - src.training.utils - INFO -  New Best Model (Val: 7.1771)
2025-06-10 16:13:04,451 - src.training.utils - INFO - [Step 600/1000] Train: 7.1719, Val: 7.1416
2025-06-10 16:13:06,063 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_transformer_e2e_single_run__transformer_e2e_sweep__bs12_cw16_lr3e-04_latest.pt at step 600
2025-06-10 16:13:08,955 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_transformer_e2e_single_run__transformer_e2e_sweep__bs12_cw16_lr3e-04_best.pt at step 600
2025-06-10 16:13:08,957 - src.training.utils - INFO -  New Best Model (Val: 7.1416)
2025-06-10 16:14:32,773 - src.training.utils - INFO - [Step 700/1000] Train: 7.1614, Val: 7.0914
2025-06-10 16:14:34,336 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_transformer_e2e_single_run__transformer_e2e_sweep__bs12_cw16_lr3e-04_latest.pt at step 700
2025-06-10 16:14:36,515 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_transformer_e2e_single_run__transformer_e2e_sweep__bs12_cw16_lr3e-04_best.pt at step 700
2025-06-10 16:14:36,521 - src.training.utils - INFO -  New Best Model (Val: 7.0914)
2025-06-10 16:15:59,950 - src.training.utils - INFO - [Step 800/1000] Train: 6.6847, Val: 7.2729
2025-06-10 16:16:00,913 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_transformer_e2e_single_run__transformer_e2e_sweep__bs12_cw16_lr3e-04_latest.pt at step 800
2025-06-10 16:16:00,914 - src.training.utils - INFO -  No improvement: 1/50
2025-06-10 16:16:32,479 - src.training.utils - INFO - [Step 900/1000] Train: 6.7749, Val: 7.2147
2025-06-10 16:16:33,605 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_transformer_e2e_single_run__transformer_e2e_sweep__bs12_cw16_lr3e-04_latest.pt at step 900
2025-06-10 16:16:33,606 - src.training.utils - INFO -  No improvement: 2/50
2025-06-10 16:17:05,089 - src.training.utils - INFO - [Step 1000/1000] Train: 6.6504, Val: 7.0978
2025-06-10 16:17:05,091 - src.training.utils - INFO -  No improvement: 3/50
2025-06-10 16:17:05,092 - src.training.utils - INFO - Training completed at step 1000. Saving final checkpoint.
2025-06-10 16:17:06,018 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_transformer_e2e_single_run__transformer_e2e_sweep__bs12_cw16_lr3e-04_latest.pt at step 1000
2025-06-10 16:17:07,187 - src.training.utils - INFO - Preserved best checkpoint at model_checkpoints/run_transformer_e2e_single_run__transformer_e2e_sweep__bs12_cw16_lr3e-04_best.pt.
2025-06-10 16:17:08,944 - src.training.utils - INFO - Loss curve saved to train_eval_plots/loss_run_transformer_e2e_single_run__transformer_e2e_sweep__bs12_cw16_lr3e-04.png and logged.
2025-06-10 16:17:08,977 - src.training.manager - INFO - Saved completion status to model_checkpoints/completion_tracking/transformer_e2e_single_run__transformer_e2e_sweep__completed.json
2025-06-10 16:17:08,977 - src.training.manager - INFO - Logging model artifact from model_checkpoints/run_transformer_e2e_single_run__transformer_e2e_sweep__bs12_cw16_lr3e-04_best.pt
2025-06-10 16:17:10,713 - src.training.manager - INFO - Logged artifact: Transformer_e2e_model-transformer_e2e_single_run__transformer_e2e_sweep_
2025-06-10 16:17:10,714 - src.training.manager - INFO - Waiting for artifact upload to complete (timeout: 300s)...
2025-06-10 16:17:34,184 - src.training.manager - INFO - Artifact upload finished.
2025-06-10 16:17:34,185 - src.training.manager - INFO - Cleaning up local checkpoint files...
2025-06-10 16:17:34,247 - src.training.manager - INFO - Removed checkpoint: model_checkpoints/run_transformer_e2e_single_run__transformer_e2e_sweep__bs12_cw16_lr3e-04_latest.pt
2025-06-10 16:17:34,329 - src.training.manager - INFO - Removed checkpoint: model_checkpoints/run_transformer_e2e_single_run__transformer_e2e_sweep__bs12_cw16_lr3e-04_best.pt
2025-06-10 16:17:34,330 - src.training.manager - INFO - Training did not complete successfully - preserving checkpoints for resumption.
2025-06-10 16:17:36,544 - __main__ - INFO - Training process finished.
2025-06-10 16:22:18,197 - __main__ - INFO - Starting training process with mode: single
2025-06-10 16:22:18,198 - src.data.processing - INFO - Loading wikitext dataset.
2025-06-10 16:22:36,982 - src.data.processing - INFO - Successfully loaded dataset.
2025-06-10 16:22:37,208 - src.data.processing - INFO - Truncated wikitext to 10000000 characters for CPU training.
2025-06-10 16:22:37,208 - src.data.processing - INFO - Loading tokenizer 'gpt2'...
2025-06-10 16:22:39,781 - src.training.manager - INFO - Found completion status for run transformer_e2e_single_run__transformer_e2e_sweep_: all_steps_completed at step 1000
2025-06-10 16:22:39,782 - src.training.manager - INFO - Run transformer_e2e_single_run__transformer_e2e_sweep_ was already completed. Creating new run with suffix.
2025-06-10 16:22:39,783 - src.training.manager - INFO - Using new run ID: transformer_e2e_single_run__transformer_e2e_sweep__2
2025-06-10 16:22:39,784 - src.training.manager - INFO - Starting training run: transformer_e2e_single_run__transformer_e2e_sweep__2
2025-06-10 16:22:43,139 - src.training.manager - INFO - Run created at: 2025-06-10 16:22:39
2025-06-10 16:22:43,140 - src.training.manager - INFO - Starting fresh - Python 3.11.8
2025-06-10 16:22:43,158 - src.data.processing - INFO - Tokenizing the entire dataset..
2025-06-10 16:23:03,190 - src.data.processing - INFO - Tokenization complete. Total tokens: 2197766
2025-06-10 16:23:03,394 - src.data.processing - INFO - Train tokens: 1780191, Val tokens: 197798, Test tokens: 219777
2025-06-10 16:23:03,446 - src.models.transformer - INFO - Linearly scaling dropout from 0.100 to 0.200 over 3 layers. Result: [0.1, 0.15, 0.2]
2025-06-10 16:23:03,542 - src.training.utils - INFO - No checkpoint found. Starting fresh.
2025-06-10 16:23:05,112 - src.training.utils - INFO - Starting/Resuming training on cpu
2025-06-10 16:23:17,071 - __main__ - INFO - Training process finished.
2025-06-10 16:26:42,403 - __main__ - INFO - Starting training process with mode: single
2025-06-10 16:26:42,403 - src.data.processing - INFO - Loading wikitext dataset.
2025-06-10 16:26:53,828 - src.data.processing - INFO - Successfully loaded dataset.
2025-06-10 16:26:54,008 - src.data.processing - INFO - Truncated wikitext to 10000000 characters for CPU training.
2025-06-10 16:26:54,008 - src.data.processing - INFO - Loading tokenizer 'gpt2'...
2025-06-10 16:26:55,113 - src.training.manager - INFO - No previous data for transformer_e2e_single_run. Starting fresh training.
2025-06-10 16:26:55,113 - src.training.manager - INFO - Starting training run: transformer_e2e_single_run
2025-06-10 16:26:57,622 - src.training.manager - INFO - Run created at: 2025-06-10 16:26:55
2025-06-10 16:26:57,623 - src.training.manager - INFO - Starting fresh - Python 3.11.8
2025-06-10 16:26:57,644 - src.data.processing - INFO - Tokenizing the entire dataset..
2025-06-10 16:27:11,098 - src.data.processing - INFO - Tokenization complete. Total tokens: 2197766
2025-06-10 16:27:11,343 - src.data.processing - INFO - Train tokens: 1780191, Val tokens: 197798, Test tokens: 219777
2025-06-10 16:27:11,403 - src.models.transformer - INFO - Linearly scaling dropout from 0.100 to 0.200 over 3 layers. Result: [0.1, 0.15, 0.2]
2025-06-10 16:27:11,525 - src.training.utils - INFO - No checkpoint found. Starting fresh.
2025-06-10 16:27:12,968 - src.training.utils - INFO - Starting/Resuming training on cpu
2025-06-10 16:27:17,707 - __main__ - INFO - Training process finished.
2025-06-10 16:48:21,436 - __main__ - INFO - Starting training process with mode: single
2025-06-10 16:48:21,437 - src.data.processing - INFO - Loading wikitext dataset.
2025-06-10 16:48:32,638 - src.data.processing - INFO - Successfully loaded dataset.
2025-06-10 16:48:33,204 - src.data.processing - INFO - Truncated wikitext to 10000000 characters for CPU training.
2025-06-10 16:48:33,206 - src.data.processing - INFO - Loading tokenizer 'gpt2'...
2025-06-10 16:48:34,481 - __main__ - CRITICAL - Unhandled error in single run: Unknown format code 'e' for object of type 'str'
Traceback (most recent call last):
  File "/Users/kritiagrawal/Desktop/job_practice/ml_engineering/transformer_e2e/scripts/train.py", line 68, in main
    run_single_training(raw_text, tokenizer, cfg)
  File "/Users/kritiagrawal/Desktop/job_practice/ml_engineering/transformer_e2e/src/training/manager.py", line 583, in run_single_training
    base_run_id = f"single_bs{cfg.BATCH_SIZE}_cw{cfg.CONTEXT_WINDOW}_lr{cfg.LEARNING_RATE:.0e}"
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Unknown format code 'e' for object of type 'str'
2025-06-10 16:48:34,485 - __main__ - INFO - Training process finished.
2025-06-10 16:51:07,599 - __main__ - INFO - Starting training process with mode: single
2025-06-10 16:51:07,601 - src.data.processing - INFO - Loading wikitext dataset.
2025-06-10 16:51:19,189 - src.data.processing - INFO - Successfully loaded dataset.
2025-06-10 16:51:19,413 - src.data.processing - INFO - Truncated wikitext to 10000000 characters for CPU training.
2025-06-10 16:51:19,413 - src.data.processing - INFO - Loading tokenizer 'gpt2'...
2025-06-10 16:51:20,601 - src.training.manager - INFO - No previous data for single_bs12_cw16_lr3e-4. Starting fresh training.
2025-06-10 16:51:20,604 - src.training.manager - INFO - Starting training run: single_bs12_cw16_lr3e-4
2025-06-10 16:51:23,530 - src.training.manager - INFO - Run created at: 2025-06-10 16:51:20
2025-06-10 16:51:23,531 - src.training.manager - INFO - Starting fresh - Python 3.11.8
2025-06-10 16:51:23,574 - src.data.processing - INFO - Tokenizing the entire dataset..
2025-06-10 16:51:45,839 - src.data.processing - INFO - Tokenization complete. Total tokens: 2197766
2025-06-10 16:51:46,113 - src.data.processing - INFO - Train tokens: 1780191, Val tokens: 197798, Test tokens: 219777
2025-06-10 16:51:46,203 - src.models.transformer - INFO - Linearly scaling dropout from 0.100 to 0.200 over 3 layers. Result: [0.1, 0.15, 0.2]
2025-06-10 16:51:46,327 - src.training.utils - INFO - No checkpoint found. Starting fresh.
2025-06-10 16:51:48,245 - src.training.utils - INFO - Starting/Resuming training on cpu
2025-06-10 16:52:48,638 - src.training.utils - INFO - [Step 100/1000] Train: 7.7381, Val: 7.9780
2025-06-10 16:52:50,160 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-4_latest.pt at step 100
2025-06-10 16:52:52,056 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-4_best.pt at step 100
2025-06-10 16:52:52,056 - src.training.utils - INFO -  New Best Model (Val: 7.9780)
2025-06-10 16:53:26,920 - src.training.utils - INFO - [Step 200/1000] Train: 7.7467, Val: 7.6403
2025-06-10 16:53:29,728 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-4_latest.pt at step 200
2025-06-10 16:53:37,066 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-4_best.pt at step 200
2025-06-10 16:53:37,067 - src.training.utils - INFO -  New Best Model (Val: 7.6403)
2025-06-10 16:55:01,261 - __main__ - INFO - Training process finished.
2025-06-10 16:57:40,283 - __main__ - INFO - Starting training process with mode: single
2025-06-10 16:57:40,283 - src.data.processing - INFO - Loading wikitext dataset.
2025-06-10 16:57:51,695 - src.data.processing - INFO - Successfully loaded dataset.
2025-06-10 16:57:52,024 - src.data.processing - INFO - Truncated wikitext to 10000000 characters for CPU training.
2025-06-10 16:57:52,025 - src.data.processing - INFO - Loading tokenizer 'gpt2'...
2025-06-10 16:57:53,235 - src.training.manager - INFO - Found checkpoints for incomplete run single_bs12_cw16_lr3e-4. Resuming interrupted training.
2025-06-10 16:57:53,236 - src.training.manager - INFO - Resuming training run: single_bs12_cw16_lr3e-4
2025-06-10 16:57:56,501 - src.training.manager - INFO - Run created at: 2025-06-10 16:57:53
2025-06-10 16:57:56,502 - src.training.manager - INFO - Resuming - Python 3.11.8
2025-06-10 16:57:56,563 - src.data.processing - INFO - Tokenizing the entire dataset..
2025-06-10 16:58:08,524 - src.data.processing - INFO - Tokenization complete. Total tokens: 2197766
2025-06-10 16:58:08,711 - src.data.processing - INFO - Train tokens: 1780191, Val tokens: 197798, Test tokens: 219777
2025-06-10 16:58:08,769 - src.models.transformer - INFO - Linearly scaling dropout from 0.100 to 0.200 over 3 layers. Result: [0.1, 0.15, 0.2]
2025-06-10 16:58:08,856 - src.training.utils - INFO - Found checkpoint: model_checkpoints/run_single_bs12_cw16_lr3e-4_latest.pt. Attempting to resume.
2025-06-10 16:58:09,123 - src.training.utils - INFO - Resuming from step 201 with best_val_loss 7.9780
2025-06-10 16:58:10,611 - src.training.utils - INFO - Starting/Resuming training on cpu
2025-06-10 16:58:10,613 - src.training.utils - INFO - Loaded optimizer state from checkpoint.
2025-06-10 16:58:38,789 - src.training.utils - INFO - [Step 300/1000] Train: 7.5172, Val: 7.6373
2025-06-10 16:58:40,933 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-4_latest.pt at step 300
2025-06-10 16:58:43,499 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-4_best.pt at step 300
2025-06-10 16:58:43,499 - src.training.utils - INFO -  New Best Model (Val: 7.6373)
2025-06-10 16:59:12,115 - src.training.utils - INFO - [Step 400/1000] Train: 7.0262, Val: 7.6548
2025-06-10 16:59:14,153 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-4_latest.pt at step 400
2025-06-10 16:59:14,154 - src.training.utils - INFO -  No improvement: 1/50
2025-06-10 16:59:40,486 - src.training.utils - INFO - [Step 500/1000] Train: 6.9976, Val: 7.3397
2025-06-10 16:59:42,497 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-4_latest.pt at step 500
2025-06-10 16:59:44,877 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-4_best.pt at step 500
2025-06-10 16:59:44,878 - src.training.utils - INFO -  New Best Model (Val: 7.3397)
2025-06-10 17:00:12,959 - src.training.utils - INFO - [Step 600/1000] Train: 7.7499, Val: 7.2204
2025-06-10 17:00:14,898 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-4_latest.pt at step 600
2025-06-10 17:00:17,192 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-4_best.pt at step 600
2025-06-10 17:00:17,193 - src.training.utils - INFO -  New Best Model (Val: 7.2204)
2025-06-10 17:00:44,393 - src.training.utils - INFO - [Step 700/1000] Train: 6.6814, Val: 7.3932
2025-06-10 17:00:46,312 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-4_latest.pt at step 700
2025-06-10 17:00:46,312 - src.training.utils - INFO -  No improvement: 1/50
2025-06-10 17:01:13,553 - src.training.utils - INFO - [Step 800/1000] Train: 7.2518, Val: 7.1375
2025-06-10 17:01:15,402 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-4_latest.pt at step 800
2025-06-10 17:01:17,409 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-4_best.pt at step 800
2025-06-10 17:01:17,409 - src.training.utils - INFO -  New Best Model (Val: 7.1375)
2025-06-10 17:01:44,039 - __main__ - INFO - Training process finished.
2025-06-10 17:01:56,743 - __main__ - INFO - Starting training process with mode: single
2025-06-10 17:01:56,743 - src.data.processing - INFO - Loading wikitext dataset.
2025-06-10 17:02:08,977 - src.data.processing - INFO - Successfully loaded dataset.
2025-06-10 17:02:09,140 - src.data.processing - INFO - Truncated wikitext to 10000000 characters for CPU training.
2025-06-10 17:02:09,140 - src.data.processing - INFO - Loading tokenizer 'gpt2'...
2025-06-10 17:02:10,186 - src.training.manager - INFO - Found checkpoints for incomplete run single_bs12_cw16_lr3e-4. Resuming interrupted training.
2025-06-10 17:02:10,186 - src.training.manager - INFO - Resuming training run: single_bs12_cw16_lr3e-4
2025-06-10 17:02:12,746 - src.training.manager - INFO - Run created at: 2025-06-10 17:02:10
2025-06-10 17:02:12,747 - src.training.manager - INFO - Resuming - Python 3.11.8
2025-06-10 17:02:12,762 - src.data.processing - INFO - Tokenizing the entire dataset..
2025-06-10 17:02:23,875 - src.data.processing - INFO - Tokenization complete. Total tokens: 2197766
2025-06-10 17:02:24,061 - src.data.processing - INFO - Train tokens: 1780191, Val tokens: 197798, Test tokens: 219777
2025-06-10 17:02:24,118 - src.models.transformer - INFO - Linearly scaling dropout from 0.100 to 0.200 over 3 layers. Result: [0.1, 0.15, 0.2]
2025-06-10 17:02:24,200 - src.training.utils - INFO - Found checkpoint: model_checkpoints/run_single_bs12_cw16_lr3e-4_latest.pt. Attempting to resume.
2025-06-10 17:02:24,505 - src.training.utils - INFO - Resuming from step 801 with best_val_loss 7.2204
2025-06-10 17:02:25,767 - src.training.utils - INFO - Starting/Resuming training on cpu
2025-06-10 17:02:25,769 - src.training.utils - INFO - Loaded optimizer state from checkpoint.
2025-06-10 17:02:52,061 - src.training.utils - INFO - [Step 900/1000] Train: 7.0972, Val: 6.9466
2025-06-10 17:02:53,981 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-4_latest.pt at step 900
2025-06-10 17:02:56,139 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-4_best.pt at step 900
2025-06-10 17:02:56,139 - src.training.utils - INFO -  New Best Model (Val: 6.9466)
2025-06-10 17:03:25,306 - src.training.utils - INFO - [Step 1000/1000] Train: 7.1834, Val: 7.1610
2025-06-10 17:03:25,308 - src.training.utils - INFO -  No improvement: 1/50
2025-06-10 17:03:25,309 - src.training.utils - INFO - Training completed at step 1000. Saving final checkpoint.
2025-06-10 17:03:27,216 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-4_latest.pt at step 1000
2025-06-10 17:03:29,453 - src.training.utils - INFO - Preserved best checkpoint at model_checkpoints/run_single_bs12_cw16_lr3e-4_best.pt.
2025-06-10 17:03:31,267 - src.training.utils - INFO - Loss curve saved to train_eval_plots/loss_run_single_bs12_cw16_lr3e-4.png and logged.
2025-06-10 17:03:31,325 - src.training.manager - INFO - Saved completion status to model_checkpoints/completion_tracking/single_bs12_cw16_lr3e-4_completed.json
2025-06-10 17:03:31,326 - src.training.manager - INFO - Running post-training evaluations...
2025-06-10 17:03:31,460 - src.training.manager - INFO - Loaded best model from model_checkpoints/run_single_bs12_cw16_lr3e-4_best.pt for final eval.
2025-06-10 17:03:32,419 - src.training.manager - INFO - Average Test Set Loss: 7.3594
2025-06-10 17:03:32,456 - src.training.manager - INFO - Logging model artifact from model_checkpoints/run_single_bs12_cw16_lr3e-4_best.pt
2025-06-10 17:03:33,799 - src.training.manager - INFO - Logged artifact: Transformer_e2e_model-single_bs12_cw16_lr3e-4
2025-06-10 17:03:33,799 - src.training.manager - INFO - Waiting for artifact upload to complete (timeout: 300s)...
2025-06-10 17:03:53,693 - src.training.manager - INFO - Artifact upload finished.
2025-06-10 17:03:53,695 - src.training.manager - INFO - Cleaning up local checkpoint files...
2025-06-10 17:03:53,820 - src.training.manager - INFO - Removed checkpoint: model_checkpoints/run_single_bs12_cw16_lr3e-4_latest.pt
2025-06-10 17:03:53,931 - src.training.manager - INFO - Removed checkpoint: model_checkpoints/run_single_bs12_cw16_lr3e-4_best.pt
2025-06-10 17:03:53,932 - src.training.manager - INFO - Training did not complete successfully - preserving checkpoints for resumption.
2025-06-10 17:03:56,289 - __main__ - INFO - Training process finished.
2025-06-10 17:04:10,377 - __main__ - INFO - Starting training process with mode: single
2025-06-10 17:04:10,378 - src.data.processing - INFO - Loading wikitext dataset.
2025-06-10 17:04:21,988 - src.data.processing - INFO - Successfully loaded dataset.
2025-06-10 17:04:22,145 - src.data.processing - INFO - Truncated wikitext to 10000000 characters for CPU training.
2025-06-10 17:04:22,145 - src.data.processing - INFO - Loading tokenizer 'gpt2'...
2025-06-10 17:04:23,181 - src.training.manager - INFO - Found completion status for run single_bs12_cw16_lr3e-4: all_steps_completed at step 1000
2025-06-10 17:04:23,182 - src.training.manager - INFO - Run single_bs12_cw16_lr3e-4 was already completed. Creating new run with suffix.
2025-06-10 17:04:23,182 - src.training.manager - INFO - Using new run ID: single_bs12_cw16_lr3e-4_2
2025-06-10 17:04:23,182 - src.training.manager - INFO - Starting training run: single_bs12_cw16_lr3e-4_2
2025-06-10 17:04:25,924 - src.training.manager - INFO - Run created at: 2025-06-10 17:04:23
2025-06-10 17:04:25,925 - src.training.manager - INFO - Starting fresh - Python 3.11.8
2025-06-10 17:04:25,940 - src.data.processing - INFO - Tokenizing the entire dataset..
2025-06-10 17:04:37,289 - src.data.processing - INFO - Tokenization complete. Total tokens: 2197766
2025-06-10 17:04:37,473 - src.data.processing - INFO - Train tokens: 1780191, Val tokens: 197798, Test tokens: 219777
2025-06-10 17:04:37,531 - src.models.transformer - INFO - Linearly scaling dropout from 0.100 to 0.200 over 3 layers. Result: [0.1, 0.15, 0.2]
2025-06-10 17:04:37,607 - src.training.utils - INFO - No checkpoint found. Starting fresh.
2025-06-10 17:04:38,836 - src.training.utils - INFO - Starting/Resuming training on cpu
2025-06-10 17:05:07,335 - src.training.utils - INFO - [Step 100/1000] Train: 7.7363, Val: 8.0060
2025-06-10 17:05:08,997 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-4_2_latest.pt at step 100
2025-06-10 17:05:11,287 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-4_2_best.pt at step 100
2025-06-10 17:05:11,287 - src.training.utils - INFO -  New Best Model (Val: 8.0060)
2025-06-10 17:05:39,748 - src.training.utils - INFO - [Step 200/1000] Train: 7.8968, Val: 7.8732
2025-06-10 17:05:41,693 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_single_bs12_cw16_lr3e-4_2_latest.pt at step 200
2025-06-10 17:05:46,606 - __main__ - INFO - Training process finished.
2025-06-10 17:06:03,322 - __main__ - INFO - Starting training process with mode: sweep
2025-06-10 17:06:03,322 - src.data.processing - INFO - Loading wikitext dataset.
2025-06-10 17:06:14,505 - src.data.processing - INFO - Successfully loaded dataset.
2025-06-10 17:06:14,672 - src.data.processing - INFO - Truncated wikitext to 10000000 characters for CPU training.
2025-06-10 17:06:14,672 - src.data.processing - INFO - Loading tokenizer 'gpt2'...
2025-06-10 17:06:15,686 - src.training.manager - INFO - --- Starting Hyperparameter Search ---
2025-06-10 17:06:15,686 - src.training.manager - INFO - Hyperparameter sweep started at: 20250610_1706
2025-06-10 17:06:15,688 - src.training.manager - INFO - Found completion status for run tune_bs8_cw32_lr3e-04: early_stopping at step 1200
2025-06-10 17:06:15,688 - src.training.manager - INFO - Run tune_bs8_cw32_lr3e-04 was already completed. Creating new run with suffix.
2025-06-10 17:06:15,689 - src.training.manager - INFO - Found completion status for run tune_bs8_cw32_lr3e-04_2: early_stopping at step 1450
2025-06-10 17:06:15,690 - src.training.manager - INFO - Using new run ID: tune_bs8_cw32_lr3e-04_3
2025-06-10 17:06:15,690 - src.training.manager - INFO - Starting Tuning Run: transformer_e2e_sweep__tune_bs8_cw32_lr3e-04_3 (new)
2025-06-10 17:06:15,690 - src.training.manager - INFO - Starting training run: tune_bs8_cw32_lr3e-04_3
2025-06-10 17:06:18,191 - src.training.manager - INFO - Run created at: 2025-06-10 17:06:15
2025-06-10 17:06:18,192 - src.training.manager - INFO - Starting fresh - Python 3.11.8
2025-06-10 17:06:18,208 - src.data.processing - INFO - Tokenizing the entire dataset..
2025-06-10 17:06:29,571 - src.data.processing - INFO - Tokenization complete. Total tokens: 2197766
2025-06-10 17:06:29,776 - src.data.processing - INFO - Train tokens: 1780191, Val tokens: 197798, Test tokens: 219777
2025-06-10 17:06:29,833 - src.models.transformer - INFO - Linearly scaling dropout from 0.100 to 0.200 over 3 layers. Result: [0.1, 0.15, 0.2]
2025-06-10 17:06:29,911 - src.training.utils - INFO - No checkpoint found. Starting fresh.
2025-06-10 17:06:31,281 - src.training.utils - INFO - Starting/Resuming training on cpu
2025-06-10 17:06:39,416 - src.training.utils - INFO - [Step 25/5000] Train: 10.1868, Val: 10.0037
2025-06-10 17:06:41,149 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_3_latest.pt at step 25
2025-06-10 17:06:43,268 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_3_best.pt at step 25
2025-06-10 17:06:43,268 - src.training.utils - INFO -  New Best Model (Val: 10.0037)
2025-06-10 17:06:51,695 - src.training.utils - INFO - [Step 50/5000] Train: 9.1009, Val: 8.9762
2025-06-10 17:06:53,698 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_3_latest.pt at step 50
2025-06-10 17:06:55,849 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_3_best.pt at step 50
2025-06-10 17:06:55,849 - src.training.utils - INFO -  New Best Model (Val: 8.9762)
2025-06-10 17:07:06,902 - src.training.utils - INFO - [Step 75/5000] Train: 8.4246, Val: 8.2557
2025-06-10 17:07:08,691 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_3_latest.pt at step 75
2025-06-10 17:07:10,654 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_3_best.pt at step 75
2025-06-10 17:07:10,654 - src.training.utils - INFO -  New Best Model (Val: 8.2557)
2025-06-10 17:07:19,067 - src.training.utils - INFO - [Step 100/5000] Train: 7.5896, Val: 7.8798
2025-06-10 17:07:21,098 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_3_latest.pt at step 100
2025-06-10 17:07:23,451 - src.training.utils - INFO - Checkpoint saved to model_checkpoints/run_tune_bs8_cw32_lr3e-04_3_best.pt at step 100
2025-06-10 17:07:23,452 - src.training.utils - INFO -  New Best Model (Val: 7.8798)
2025-06-10 17:07:29,421 - __main__ - INFO - Training process finished.
